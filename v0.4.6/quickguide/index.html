<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quick Guide · ComplexMixtures</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="ComplexMixtures logo"/></a><div class="docs-package-name"><span class="docs-autofit">ComplexMixtures</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Introduction</a></li><li><a class="tocitem" href="../installation/">Installation</a></li><li class="is-active"><a class="tocitem" href>Quick Guide</a></li><li><a class="tocitem" href="../selection/">Set solute and solvent</a></li><li><a class="tocitem" href="../trajectory/">Loading the trajectory</a></li><li><a class="tocitem" href="../mddf/">Computing the MDDF</a></li><li><a class="tocitem" href="../results/">Results</a></li><li><a class="tocitem" href="../contrib/">Atomic and group contributions</a></li><li><a class="tocitem" href="../save/">Save and load</a></li><li><a class="tocitem" href="../multiple/">Multiple trajectories</a></li><li><a class="tocitem" href="../parallel/">Parallel execution</a></li><li><a class="tocitem" href="../options/">Options</a></li><li><a class="tocitem" href="../tools/">Tools</a></li><li><a class="tocitem" href="../examples/">Examples</a></li><li><a class="tocitem" href="../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Quick Guide</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Quick Guide</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/m3g/ComplexMixtures/blob/master/docs/src/quickguide.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Quick-Guide"><a class="docs-heading-anchor" href="#Quick-Guide">Quick Guide</a><a id="Quick-Guide-1"></a><a class="docs-heading-anchor-permalink" href="#Quick-Guide" title="Permalink"></a></h1><p>Of course, follow the <a href="../installation/#Installation">installation</a> instructions first.  Start <code>julia</code> and load the ComplexMixtures package, using:</p><pre><code class="language-julia">using ComplexMixtures</code></pre><p>And here we will use the <code>PDBTools</code> package to obtain the selections of the solute and solvent molecules: </p><pre><code class="language-julia">using PDBTools</code></pre><p>(see <a href="../selection/#selections">Set solute and solvent</a> for details).</p><p>The fastest way to understand how to use this package is through an example.  </p><p>Let us consider a system consisting of three components: a protein, water, a cossolvent: TMAO (trimetylamine-N-oxyde), which is a common osmolyte known to stabilize protein structures. A picture of this system is shown below, with the protein in blue, water, and TMAO molecules. The system was constructed with <a href="http://m3g.iqm.unicamp.br/packmol">Packmol</a> and the figure was produced with <a href="https://www.ks.uiuc.edu/Research/vmd/">VMD</a>.</p><img src="../figures/proteinTMAO.png" width=60%><p>We want to study the interactions of the protein with TMAO, for example. The computation of the MDDF is performed by defining the solute and solvent selections, and running the calculation on the trajectory.</p><h3 id="Define-the-protein-as-the-solute"><a class="docs-heading-anchor" href="#Define-the-protein-as-the-solute">Define the protein as the solute</a><a id="Define-the-protein-as-the-solute-1"></a><a class="docs-heading-anchor-permalink" href="#Define-the-protein-as-the-solute" title="Permalink"></a></h3><p>To define the protein as the solute, we will use the PDBTools package, which provides a handy selection syntax. First, read the PDB file using </p><pre><code class="language-julia">atoms = PDBTools.readPDB(&quot;./system.pdb&quot;)
</code></pre><p>Then, let us select the protein atoms (here we are using the <code>PDBTools.select</code> function):</p><pre><code class="language-julia">protein = select(atoms,&quot;protein&quot;)
</code></pre><p>And, finally, let us use the <code>ComplexMixtures.Selection</code> function to setup the structure required by the MDDF calculation:</p><pre><code class="language-julia">solute = ComplexMixtures.Selection(protein,nmols=1)
</code></pre><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>It is necessary to indicate how many molecules (in this case, <code>nmols=1</code>, so that ComplexMixtures knows that the solute is to be considered as single structure. In this case there is no ambiguity, but if the solute was a miscele, for example, this option would let  ComplexMixtures know that one wants to consider the miscele as a single  structure.</p></div></div><h3 id="Define-TMAO-the-solvent-to-be-considered"><a class="docs-heading-anchor" href="#Define-TMAO-the-solvent-to-be-considered">Define TMAO the solvent to be considered</a><a id="Define-TMAO-the-solvent-to-be-considered-1"></a><a class="docs-heading-anchor-permalink" href="#Define-TMAO-the-solvent-to-be-considered" title="Permalink"></a></h3><p>Equivalently, the solvent is set up with:</p><pre><code class="language-julia">tmao = select(atoms,&quot;resname TMAO&quot;)
solvent = ComplexMixtures.Selection(tmao,natomspermol=14)
</code></pre><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Here we opted to provide the number of atoms of a TMAO molecules (with the <code>natomspermol</code> keyword). This is generally more practical for small molecules than to provide the number of molecules.</p></div></div><h3 id="Set-the-Trajectory-structure"><a class="docs-heading-anchor" href="#Set-the-Trajectory-structure">Set the Trajectory structure</a><a id="Set-the-Trajectory-structure-1"></a><a class="docs-heading-anchor-permalink" href="#Set-the-Trajectory-structure" title="Permalink"></a></h3><p>The <code>solute</code> and <code>solvent</code> data structures are then fed into the <code>Trajectory</code> data structure, together with the trajectory file name, with:</p><pre><code class="language-julia">trajectory = ComplexMixtures.Trajectory(&quot;trajectory.dcd&quot;,solute,solvent)</code></pre><p>In the case, the trajectory is of NAMD &quot;dcd&quot; format. All formats supported by <a href="http://chemfiles.org/Chemfiles.jl/latest/">Chemfiles</a>  are automatically recognized. </p><h3 id="Finally,-run-the-computation-and-get-the-results:"><a class="docs-heading-anchor" href="#Finally,-run-the-computation-and-get-the-results:">Finally, run the computation and get the results:</a><a id="Finally,-run-the-computation-and-get-the-results:-1"></a><a class="docs-heading-anchor-permalink" href="#Finally,-run-the-computation-and-get-the-results:" title="Permalink"></a></h3><p>If default options are used (as the bin size of the histograms, read all frames without skipping any), just run the <code>mddf</code> with:</p><pre><code class="language-julia">results = ComplexMixtures.mddf(trajectory)
</code></pre><p>Some optional parameters for the computation are available in the <a href="../options/#options">Options</a> section.</p><h3 id="The-results-data-structure-obtained"><a class="docs-heading-anchor" href="#The-results-data-structure-obtained">The <code>results</code> data structure obtained</a><a id="The-results-data-structure-obtained-1"></a><a class="docs-heading-anchor-permalink" href="#The-results-data-structure-obtained" title="Permalink"></a></h3><p>The <code>results</code> data structure contains all the results of the MDDF calculation, including:</p><p><code>results.d</code> : Vector containing the distances to the solute. </p><p><code>results.mddf</code> : Vector containing the minimum-distance distribution function at each distance.</p><p>That means, for example, that </p><pre><code class="language-julia">plot(results.d,results.mddf,xlabel=&quot;d / \AA&quot;,ylabel=&quot;MDDF&quot;) 
</code></pre><p>results in the expected plot of the MDDF of TMAO as a function of the distance to the protein:</p><img src="../figures/mddf.png" width="60%">
<p>The Kirkwood-Buff integral corresponding to that distribution is provided in the <code>results.kb</code> vector, and can be also directly plotted  with   </p><pre><code class="language-julia">plot(results.d,results.kb,xlabel=&quot;d / \AA&quot;,ylabel=&quot;MDDF&quot;) 

</code></pre><p>to obtain:</p><img src="../figures/kb.png" width="60%">
<p>See the <a href="../contrib/#contrib">Atomic and group contributions</a> section for a detailed account on how to obtain a molecular picture of the solvation by splitting the MDDF in the contributions of each type of atom of the solvent, each type of residue of the protein, etc.</p><h3 id="Save-the-results"><a class="docs-heading-anchor" href="#Save-the-results">Save the results</a><a id="Save-the-results-1"></a><a class="docs-heading-anchor-permalink" href="#Save-the-results" title="Permalink"></a></h3><p>The results can be saved into a file (with JSON format) with:</p><pre><code class="language-julia">ComplexMixtures.save(results,&quot;./results.json&quot;)</code></pre><p>And these results can be loaded aftwerwards with:</p><pre><code class="language-julia">ComplexMixtures.load(&quot;./results.json&quot;)</code></pre><p>Alternatively, a human-readable set of output files can be obtained to be analyzed in other software (or plotted with alternative tools), with</p><pre><code class="language-julia">ComplexMixtures.write(results,&quot;./results.dat&quot;)</code></pre><h3 id="Summary"><a class="docs-heading-anchor" href="#Summary">Summary</a><a id="Summary-1"></a><a class="docs-heading-anchor-permalink" href="#Summary" title="Permalink"></a></h3><p>The complete running example, therefore, is:</p><pre><code class="language-julia"># Load packages
using PDBTools
using ComplexMixtures 
using Plots

# Load PDB file of the system
atoms = PDBTools.readPDB(&quot;./system.pdb&quot;)

# Select the protein and the TMAO molecules
protein = PDBTools.select(atoms,&quot;protein&quot;)
tmao = PDBTools.select(atoms,&quot;resname TMAO&quot;)

# Setup solute and solvent structures
solute = ComplexMixtures.Selection(protein,nmols=1)
solvent = ComplexMixtures.Selection(tmao,natomspermol=14)

# Setup the Trajectory structure
trajectory = ComplexMixtures.Trajectory(&quot;./trajectory.dcd&quot;,solute,solvent)

# Run the calculation and get results
results = ComplexMixtures.mddf(trajectory)

# Save the reults to recover them later if required
ComplexMixtures.save(results,&quot;./results.json&quot;)

# Plot the some of the most important results 
plot(results.d,results.mddf,xlabel=&quot;d&quot;,ylabel=&quot;MDDF&quot;) # plot the MDDF
savefig(&quot;./mddf.pdf&quot;)
plot(results.d,results.kb,xlabel=&quot;d&quot;,ylabel=&quot;KB&quot;) # plot the KB 
savefig(&quot;./kb.pdf&quot;)
</code></pre><p>Given that this code is saved into a file named <code>example.jl</code>,  it can be run within the Julia REPL with:</p><pre><code class="language-julia">julia&gt; include(&quot;example.jl&quot;)
</code></pre><p>or directly with:</p><pre><code class="language-none">% julia -t 4 example.jl
</code></pre><p>where <code>-t 4</code> is optional and defines how many processors will be used in the calculation.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../installation/">« Installation</a><a class="docs-footer-nextpage" href="../selection/">Set solute and solvent »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Sunday 1 November 2020 21:39">Sunday 1 November 2020</span>. Using Julia version 1.5.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
