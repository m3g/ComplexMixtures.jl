<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>From Python · ComplexMixtures.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img class="docs-light-only" src="../assets/logo.svg" alt="ComplexMixtures.jl logo"/><img class="docs-dark-only" src="../assets/logo-dark.svg" alt="ComplexMixtures.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">ComplexMixtures.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Introduction</a></li><li><a class="tocitem" href="../installation/">Installation</a></li><li><a class="tocitem" href="../parallel/">Parallel execution</a></li><li><a class="tocitem" href="../quickguide/">Quick Guide</a></li><li><a class="tocitem" href="../examples/">Full Example</a></li><li><a class="tocitem" href="../selection/">Set solute and solvent</a></li><li><a class="tocitem" href="../trajectory/">Loading the trajectory</a></li><li><a class="tocitem" href="../mddf/">Computing the MDDF</a></li><li><a class="tocitem" href="../results/">Results</a></li><li><a class="tocitem" href="../contrib/">Atomic and group contributions</a></li><li><a class="tocitem" href="../save/">Save and load</a></li><li><a class="tocitem" href="../multiple/">Multiple trajectories</a></li><li><a class="tocitem" href="../options/">Options</a></li><li><a class="tocitem" href="../tools/">Tools</a></li><li class="is-active"><a class="tocitem" href>From Python</a><ul class="internal"><li><a class="tocitem" href="#Loading-the-ComplexMixtures.py-file"><span>Loading the <code>ComplexMixtures.py</code> file</span></a></li><li><a class="tocitem" href="#Installing-juliacall"><span>Installing <code>juliacall</code></span></a></li><li><a class="tocitem" href="#Installing-Julia-and-underlying-packages"><span>Installing Julia and underlying packages</span></a></li><li><a class="tocitem" href="#How-to-run-this-example"><span>How to run this example</span></a></li><li><a class="tocitem" href="#Minimum-Distance-Distribuion-function"><span>Minimum-Distance Distribuion function</span></a></li><li><a class="tocitem" href="#Atomic-contributions-to-the-MDDF"><span>Atomic contributions to the MDDF</span></a></li></ul></li><li><a class="tocitem" href="../help/">Help entries</a></li><li><a class="tocitem" href="../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>From Python</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>From Python</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/m3g/ComplexMixtures.jl/blob/main/docs/src/python.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="python"><a class="docs-heading-anchor" href="#python">From Python</a><a id="python-1"></a><a class="docs-heading-anchor-permalink" href="#python" title="Permalink"></a></h1><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Most features of the package are available through this Python interface. However, some flexibility may be reduced and, also, the tunning of the plot appearance is left to the user, as it is expected that he/she is fluent with some tools within Python if chosing this interface.</p><p>Python 3 or greater is required.</p><p>Please report issues, incompatibilities, or any other difficulty in using the package and its interface.</p></div></div><p>The following examples consider a system composed a protein solvated by a mixture of water and glycerol, built with <a href="http://m3g.iqm.unicamp.br/packmol">Packmol</a>. The simulations were performed with <a href="https://www.ks.uiuc.edu/Research/namd/">NAMD</a> with periodic boundary conditions and a NPT ensemble at room temperature and pressure. Molecular pictures were produced with <a href="https://www.ks.uiuc.edu/Research/vmd/">VMD</a>.</p><center>
<img width=50% src="https://github.com/m3g/ComplexMixturesExamples/raw/main/Protein_in_Glycerol/Data/system.png">
</center><p>Image of the system of the example: a protein solvated by a mixture of glycreol (green) and water, at a concentration of 50%vv. The complete example is available at <a href="https://github.com/m3g/ComplexMixturesExamples/tree/main/Protein_in_Glycerol">this repository</a>.</p><h2 id="Loading-the-ComplexMixtures.py-file"><a class="docs-heading-anchor" href="#Loading-the-ComplexMixtures.py-file">Loading the <code>ComplexMixtures.py</code> file</a><a id="Loading-the-ComplexMixtures.py-file-1"></a><a class="docs-heading-anchor-permalink" href="#Loading-the-ComplexMixtures.py-file" title="Permalink"></a></h2><p>The Python interface of <code>ComplexMixtures</code> is implemented in the <a href="../assets/ComplexMixtures.py"><code>ComplexMixtures.py</code></a> file.  Just download it from the link and save it in a known path.</p><h2 id="Installing-juliacall"><a class="docs-heading-anchor" href="#Installing-juliacall">Installing <code>juliacall</code></a><a id="Installing-juliacall-1"></a><a class="docs-heading-anchor-permalink" href="#Installing-juliacall" title="Permalink"></a></h2><p><a href="https://github.com/cjdoris/PythonCall.jl"><code>juliacall</code></a> is a package that allows calling Julia programs from Python. Install it with</p><pre><code class="language-bash hljs">pip install juliacall</code></pre><h2 id="Installing-Julia-and-underlying-packages"><a class="docs-heading-anchor" href="#Installing-Julia-and-underlying-packages">Installing Julia and underlying packages</a><a id="Installing-Julia-and-underlying-packages-1"></a><a class="docs-heading-anchor-permalink" href="#Installing-Julia-and-underlying-packages" title="Permalink"></a></h2><p>Once <code>juliacall</code> is installed, from within Python, execute:</p><pre><code class="language-python hljs">import ComplexMixtures</code></pre><p>here we assume that the <code>ComplexMixtures.py</code> file is in the same directory where you launched Python.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p><strong>On the first</strong> time you execute this command, the Julia executable and the required Julia packages (<code>ComplexMixtures</code> and <code>PDBTools</code>) will be downloaded and installed. At the end of the process quit Python (not really required, but we prefer to separate the installation from the use of the module). </p></div></div><h2 id="How-to-run-this-example"><a class="docs-heading-anchor" href="#How-to-run-this-example">How to run this example</a><a id="How-to-run-this-example-1"></a><a class="docs-heading-anchor-permalink" href="#How-to-run-this-example" title="Permalink"></a></h2><p>The <a href="https://github.com/m3g/ComplexMixturesExamples/tree/main/Protein_in_Glycerol/Data">Data</a> directory contains the a pdb file of the system (<code>system.pdb</code>) and a sample from the trajectory (<code>glyc50.dcd</code>), with a few frames. It also contains the result of running the <code>mddf</code> calculation on the complete trajectory, <code>results_glyc50.json</code>. This last file was produced by <code>ComplexMixtures</code>, as indicated in the following examples. </p><p>The sample trajectory is provided so that the first example can be run, yet do not expect that the results are the same, as the sampling is much lower in this case. The complete trajectory can be retrieved from <a href="https://drive.google.com/file/d/14M30jDHRwUM77hzbDphgbu8mcWFBcQrX/view?usp=sharing">this link</a> (3GB file). </p><p>We assume that you navigated to the directory of the example, and copied the Python module file to it: </p><pre><code class="language-bash hljs">git clone https://github.com/m3g/ComplexMixturesExamples
cd ComplexMixturesExamples/Protein_in_Glycerol/MDDF
cp /path/to/ComplexMixtures.py ./
export JULIA_NUM_THREADS=8</code></pre><p>The last line will allow Julia to execute multi-threaded, which will improve a lot the performance on most machines. Set the number of threads to the number of cores of your computer.</p><h2 id="Minimum-Distance-Distribuion-function"><a class="docs-heading-anchor" href="#Minimum-Distance-Distribuion-function">Minimum-Distance Distribuion function</a><a id="Minimum-Distance-Distribuion-function-1"></a><a class="docs-heading-anchor-permalink" href="#Minimum-Distance-Distribuion-function" title="Permalink"></a></h2><p>Note that the example here follows an identical syntax to the Julia example, except that we qualify the name of the loaded module and implicitly load the <code>PDBTools</code> package.</p><p>The script to compute the MDDFs as associated data from within python is, then:</p><pre><code class="language-python hljs">import ComplexMixtures as cm

# Load the pdb file of the system using `PDBTools`:
atoms = cm.readPDB(&quot;../Data/system.pdb&quot;)

# Create arrays of atoms with the protein and Glycerol atoms, 
# using the `select` function of the `PDBTools` package:
protein = cm.select(atoms,&quot;protein&quot;)
glyc = cm.select(atoms,&quot;resname GLYC&quot;)

# Setup solute and solvent structures, required for computing the MDDF, 
# with `Selection` function of the `ComplexMixtures` package:
solute = cm.Selection(protein,nmols=1)
solvent = cm.Selection(glyc,natomspermol=14)

# Read and setup the Trajectory structure required for the computations:
trajectory = cm.Trajectory(&quot;../Data/glyc50_complete.dcd&quot;,solute,solvent)

# Run the calculation and get results:
results = cm.mddf(trajectory)

# Save the reults to recover them later if required
cm.save(results,&quot;./glyc50.json&quot;)</code></pre><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>To change the options of the calculation, set the <code>Options</code> structure accordingly and pass it as a parameter to <code>mddf</code>. For example:</p><pre><code class="language-python hljs">options = cm.Options(cutoff=10.)
results = cm.mddf(trajectory,options)</code></pre><p>The complete set of options available is described <a href="../options/#options">here</a>.</p></div></div><p>The trajectory that was loaded was for a toy-example. The complete trajectory is available <a href="https://drive.google.com/file/d/14M30jDHRwUM77hzbDphgbu8mcWFBcQrX/view?usp=sharing">here</a>, but it is a 3GB file. The same procedure above was performed with that file and produced the <code>results_Glyc50.json</code> file, which is available in the Data directory here. We will continue with this file instead. </p><h3 id="Produce-plots"><a class="docs-heading-anchor" href="#Produce-plots">Produce plots</a><a id="Produce-plots-1"></a><a class="docs-heading-anchor-permalink" href="#Produce-plots" title="Permalink"></a></h3><h4 id="MDDF-and-Kirkwood-Buff-integrals"><a class="docs-heading-anchor" href="#MDDF-and-Kirkwood-Buff-integrals">MDDF and Kirkwood-Buff integrals</a><a id="MDDF-and-Kirkwood-Buff-integrals-1"></a><a class="docs-heading-anchor-permalink" href="#MDDF-and-Kirkwood-Buff-integrals" title="Permalink"></a></h4><pre><code class="language-python hljs">import ComplexMixtures as cm
import matplotlib.pyplot as plt

# Load the actual results obtained with the complete simulation:
results = cm.load(&quot;../Data/results_glyc50.json&quot;)

# Plot MDDF and KB
fig, axs = plt.subplots(2)
axs[0].plot(results.d, results.mddf)
axs[0].set(ylabel=&quot;MDDF&quot;)

# Plot KB integral
axs[1].plot(results.d, results.kb)
axs[1].set(xlabel=&quot;distance / Angs&quot;, ylabel=&quot;MDDF&quot;)

plt.savefig(&quot;mddf_kb.png&quot;)</code></pre><h2 id="Atomic-contributions-to-the-MDDF"><a class="docs-heading-anchor" href="#Atomic-contributions-to-the-MDDF">Atomic contributions to the MDDF</a><a id="Atomic-contributions-to-the-MDDF-1"></a><a class="docs-heading-anchor-permalink" href="#Atomic-contributions-to-the-MDDF" title="Permalink"></a></h2><p>Selecting the atoms corresponding to the hydroxyl groups, and of the aliphatic carbons of Glycerol. Here we list the types of the atoms as specified by the force-field. </p><pre><code class="language-python hljs">import ComplexMixtures as cm
import matplotlib.pyplot as plt

atoms = cm.readPDB(&quot;../Data/system.pdb&quot;)
protein = cm.select(atoms,&quot;protein&quot;)
glyc = cm.select(atoms,&quot;resname GLYC&quot;)
solute = cm.Selection(protein,nmols=1)
solvent = cm.Selection(glyc,natomspermol=14)

# load results
results = cm.load(&quot;../Data/results_glyc50.json&quot;)

# Select atoms by name
hydroxyls = cm.list([&quot;O1&quot;,&quot;O2&quot;,&quot;O3&quot;,&quot;H1&quot;,&quot;H2&quot;,&quot;H3&quot;])
aliphatic = cm.list([&quot;C1&quot;,&quot;C2&quot;,&quot;HA&quot;,&quot;HB&quot;,&quot;HC&quot;,&quot;HD&quot;])

# Extract the contributions of the groups above
hydr_contributions = cm.contributions(solvent,results.solvent_atom,hydroxyls)
aliph_contributions = cm.contributions(solvent,results.solvent_atom,aliphatic)

# Plot
plt.plot(results.d, results.mddf)
plt.plot(results.d, hydr_contributions)
plt.plot(results.d, aliph_contributions)
plt.xlabel(&quot;distance / Angs&quot;)
plt.ylabel(&quot;MDDF&quot;)
plt.savefig(&quot;group_contributions.png&quot;)</code></pre><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The syntax here diverges from the Julia-only examples by requiring the lists of names to be converted to Julia arrays, which happens by using the <code>cm.list(python_list)</code> function calls.</p></div></div></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../tools/">« Tools</a><a class="docs-footer-nextpage" href="../help/">Help entries »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Monday 21 August 2023 19:19">Monday 21 August 2023</span>. Using Julia version 1.9.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
