<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quick Guide · ComplexMixtures.jl</title><meta name="title" content="Quick Guide · ComplexMixtures.jl"/><meta property="og:title" content="Quick Guide · ComplexMixtures.jl"/><meta property="twitter:title" content="Quick Guide · ComplexMixtures.jl"/><meta name="description" content="Documentation for ComplexMixtures.jl."/><meta property="og:description" content="Documentation for ComplexMixtures.jl."/><meta property="twitter:description" content="Documentation for ComplexMixtures.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img class="docs-light-only" src="../assets/logo.svg" alt="ComplexMixtures.jl logo"/><img class="docs-dark-only" src="../assets/logo-dark.svg" alt="ComplexMixtures.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">ComplexMixtures.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Introduction</a></li><li><a class="tocitem" href="../installation/">Installation</a></li><li><a class="tocitem" href="../parallel/">Parallel execution</a></li><li class="is-active"><a class="tocitem" href>Quick Guide</a><ul class="internal"><li><a class="tocitem" href="#Basic-example"><span>Basic example</span></a></li><li><a class="tocitem" href="#Detailed-description-of-the-example"><span>Detailed description of the example</span></a></li></ul></li><li><a class="tocitem" href="../examples/">Examples:</a></li><li><a class="tocitem" href="../example1/">◦ Protein in water/glycerol</a></li><li><a class="tocitem" href="../example2/">◦ Polyacrylamide in DMF</a></li><li><a class="tocitem" href="../example3/">◦ POPC membrane in water/ethanol</a></li><li><a class="tocitem" href="../example4/">◦ Water/Glycerol mixture</a></li><li><a class="tocitem" href="../selection/">Set solute and solvent</a></li><li><a class="tocitem" href="../trajectory/">Loading the trajectory</a></li><li><a class="tocitem" href="../mddf/">Computing the MDDF</a></li><li><a class="tocitem" href="../results/">Results</a></li><li><a class="tocitem" href="../contrib/">Atomic and group contributions</a></li><li><a class="tocitem" href="../save/">Save and load</a></li><li><a class="tocitem" href="../multiple/">Multiple trajectories</a></li><li><a class="tocitem" href="../options/">Options</a></li><li><a class="tocitem" href="../tools/">Tools</a></li><li><a class="tocitem" href="../python/">From Python</a></li><li><a class="tocitem" href="../updating_scripts/">Updating scripts</a></li><li><a class="tocitem" href="../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Quick Guide</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Quick Guide</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/m3g/ComplexMixtures.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/m3g/ComplexMixtures.jl/blob/main/docs/src/quickguide.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Quick-Guide"><a class="docs-heading-anchor" href="#Quick-Guide">Quick Guide</a><a id="Quick-Guide-1"></a><a class="docs-heading-anchor-permalink" href="#Quick-Guide" title="Permalink"></a></h1><p>Of course, follow the <a href="../installation/#Installation">installation</a> instructions first.  A complete working example is shown below, and in the section that follows each  command is described in detail.</p><h2 id="Basic-example"><a class="docs-heading-anchor" href="#Basic-example">Basic example</a><a id="Basic-example-1"></a><a class="docs-heading-anchor-permalink" href="#Basic-example" title="Permalink"></a></h2><p>Here we show the input file required for the study of the solvation of a protein by the <code>TMAO</code> solvent, which is a molecule 4 atoms. The protein is assumed to be at infinite dilution in the simulation. The trajectory of the simulation is in <code>DCD</code> format in this example, which is the default output of <code>NAMD</code> and <code>CHARMM</code> simulation packages.</p><h3 id="Input-files"><a class="docs-heading-anchor" href="#Input-files">Input files</a><a id="Input-files-1"></a><a class="docs-heading-anchor-permalink" href="#Input-files" title="Permalink"></a></h3><p>The files necessary to run this would be:</p><ul><li><code>system.pdb</code>: a PDB file of the complete simulated system.</li><li><code>trajectory.dcd</code>: the simulation trajectory, here exemplified in the DCD format.</li><li><code>script.jl</code>: the Julia script, described below.</li></ul><p>These files are not provided for this example. For complete running examples, please check our <a href="../examples/#examples">examples</a> section.</p><h3 id="The-Julia-script"><a class="docs-heading-anchor" href="#The-Julia-script">The Julia script</a><a id="The-Julia-script-1"></a><a class="docs-heading-anchor-permalink" href="#The-Julia-script" title="Permalink"></a></h3><pre><code class="language-julia hljs"># Activate environment (see the Installation -&gt; Recommended Workflow manual section)
import Pkg;
Pkg.activate(&quot;.&quot;);

# Load packages
using ComplexMixtures
using PDBTools
using Plots

# Load PDB file of the system
atoms = readPDB(&quot;./system.pdb&quot;)

# Select the protein and the TMAO molecules
protein = select(atoms, &quot;protein&quot;)
tmao = select(atoms, &quot;resname TMAO&quot;)

# Setup solute and solvent structures. We need to provide
# either the number of atoms per molecule, or the number
# of molecules in each selection.
solute = AtomSelection(protein, nmols=1)
solvent = AtomSelection(tmao, natomspermol=14)

# Setup the Trajectory structure: this will define which
# coordinates are used to compute the MDDF when reading
# the trajectory file.
trajectory = Trajectory(&quot;./trajectory.dcd&quot;, solute, solvent)

# Run the calculation and get results: this is the computationally
# intensive part of the calculation.
results = mddf(trajectory, Options(bulk_range=(8.0, 12.0)))

# Save the results to recover them later if required
save(results, &quot;./results.json&quot;)

# Plot the some of the most important results.
#
# - The results.d array contains the distances. 
# - The results.mddf array contains the MDDF.
# - The results.kb array contains the Kirkwood-Buff integrals.
#
plot(results.d, results.mddf, xlabel=&quot;d / Å&quot;, ylabel=&quot;MDDF&quot;) # plot the MDDF
savefig(&quot;./mddf.pdf&quot;)
plot(results.d, results.kb, xlabel=&quot;d / Å&quot;, ylabel=&quot;KB / cm³ mol⁻¹&quot;) # plot the KB 
savefig(&quot;./kb.pdf&quot;)</code></pre><p>Given that this code is saved into a file named <code>script.jl</code>, it can be run within the Julia REPL with:</p><pre><code class="language-julia hljs">julia&gt; include(&quot;script.jl&quot;)</code></pre><p>or directly with:</p><pre><code class="nohighlight hljs">julia -t auto script.jl</code></pre><p>where <code>-t auto</code> will launch <code>julia</code> with multi-threading. It is highly recommended to use multi-threading!</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Some newer CPUs have &quot;fast&quot; and &quot;slow&quot; cores, designed for performance or energy savings. Thus using all cores, with <code>-t auto</code>, may not be the best strategy for optimal performance. Experimenting with different number of cores using <code>-t N</code> where <code>N</code> is the number of cores used is always necessary for tunning performance.</p></div></div><h2 id="Detailed-description-of-the-example"><a class="docs-heading-anchor" href="#Detailed-description-of-the-example">Detailed description of the example</a><a id="Detailed-description-of-the-example-1"></a><a class="docs-heading-anchor-permalink" href="#Detailed-description-of-the-example" title="Permalink"></a></h2><p>Start <code>julia</code> and load the ComplexMixtures package, using:</p><pre><code class="language-julia hljs">using ComplexMixtures</code></pre><p>And here we will use the <code>PDBTools</code> package to obtain the selections of the solute and solvent molecules: </p><pre><code class="language-julia hljs">using PDBTools</code></pre><p>(see <a href="../selection/#selections">Set solute and solvent</a> for details).</p><p>The fastest way to understand how to use this package is through an example.  </p><p>Let us consider a system of three components: a protein, water, a cosolvent: TMAO (trimetylamine-N-oxyde), which is a common osmolyte known to stabilize protein structures. A picture of this system is shown below, with the protein in blue, water, and TMAO molecules. The system was constructed with <a href="http://m3g.iqm.unicamp.br/packmol">Packmol</a> and the figure was produced with <a href="https://www.ks.uiuc.edu/Research/vmd/">VMD</a>.</p><center>
<img src="../figures/proteinTMAO.png" width=60%>
</center><p>We want to study the interactions of the protein with TMAO in this example. The computation of the MDDF is performed by defining the solute and solvent selections, and running the calculation on the trajectory.</p><h3 id="Define-the-protein-as-the-solute"><a class="docs-heading-anchor" href="#Define-the-protein-as-the-solute">Define the protein as the solute</a><a id="Define-the-protein-as-the-solute-1"></a><a class="docs-heading-anchor-permalink" href="#Define-the-protein-as-the-solute" title="Permalink"></a></h3><p>To define the protein as the solute, we will use the PDBTools package, which provides a handy selection syntax. First, read the PDB file using </p><pre><code class="language-julia hljs">atoms = readPDB(&quot;./system.pdb&quot;)</code></pre><p>Then, let us select the protein atoms (here we are using the <code>PDBTools.select</code> function):</p><pre><code class="language-julia hljs">protein = select(atoms, &quot;protein&quot;)</code></pre><p>And, finally, let us use the <code>AtomSelection</code> function to setup the structure required by the MDDF calculation:</p><pre><code class="language-julia hljs">solute = AtomSelection(protein, nmols=1)</code></pre><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>It is necessary to indicate how many molecules (in this case, <code>nmols=1</code>, so that ComplexMixtures knows that the solute is to be considered as single structure. In this case there is no ambiguity, but if the solute was a micelle, for example, this option would let  ComplexMixtures know that one wants to consider the micelle as a single structure.</p></div></div><h3 id="Define-TMAO-the-solvent-to-be-considered"><a class="docs-heading-anchor" href="#Define-TMAO-the-solvent-to-be-considered">Define TMAO the solvent to be considered</a><a id="Define-TMAO-the-solvent-to-be-considered-1"></a><a class="docs-heading-anchor-permalink" href="#Define-TMAO-the-solvent-to-be-considered" title="Permalink"></a></h3><p>Equivalently, the solvent is set up with:</p><pre><code class="language-julia hljs">tmao = select(atoms, &quot;resname TMAO&quot;)
solvent = AtomSelection(tmao, natomspermol=14)</code></pre><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Here we opted to provide the number of atoms of a TMAO molecules (with the <code>natomspermol</code> keyword). This is generally more practical for small molecules than to provide the number of molecules.</p></div></div><h3 id="Set-the-Trajectory-structure"><a class="docs-heading-anchor" href="#Set-the-Trajectory-structure">Set the Trajectory structure</a><a id="Set-the-Trajectory-structure-1"></a><a class="docs-heading-anchor-permalink" href="#Set-the-Trajectory-structure" title="Permalink"></a></h3><p>The <code>solute</code> and <code>solvent</code> data structures are then fed into the <code>Trajectory</code> data structure, together with the trajectory file name, with:</p><pre><code class="language-julia hljs">trajectory = Trajectory(&quot;trajectory.dcd&quot;, solute, solvent)</code></pre><p>In the case, the trajectory is of NAMD &quot;<code>DCD</code>&quot; format. All formats supported by <a href="http://chemfiles.org/Chemfiles.jl/latest/">Chemfiles</a>  are automatically recognized. </p><h3 id="Finally,-run-the-computation-and-get-the-results:"><a class="docs-heading-anchor" href="#Finally,-run-the-computation-and-get-the-results:">Finally, run the computation and get the results:</a><a id="Finally,-run-the-computation-and-get-the-results:-1"></a><a class="docs-heading-anchor-permalink" href="#Finally,-run-the-computation-and-get-the-results:" title="Permalink"></a></h3><p>If default options are used (as the bin size of the histograms, read all frames without skipping any), just run the <code>mddf</code> with:</p><pre><code class="language-julia hljs">results = mddf(trajectory, Options(bulk_range=(8.0, 12.0)))
</code></pre><p>Some optional parameters for the computation are available in the <a href="../options/#options">Options</a> section. Depending on the number of atoms and trajectory length, this can take a while. Computing a MDDF is much more expensive than computing a regular radial distribution function, because the normalization requires the generation of an ideal distribution of the molecules in the system.  </p><h3 id="The-results-data-structure-obtained"><a class="docs-heading-anchor" href="#The-results-data-structure-obtained">The <code>results</code> data structure obtained</a><a id="The-results-data-structure-obtained-1"></a><a class="docs-heading-anchor-permalink" href="#The-results-data-structure-obtained" title="Permalink"></a></h3><p>The <code>results</code> data structure contains all the results of the MDDF calculation, including:</p><p><code>results.d</code> : Vector containing the distances to the solute. </p><p><code>results.mddf</code> : Vector containing the minimum-distance distribution function at each distance.</p><p>That means, for example, that </p><pre><code class="language-julia hljs">plot(results.d, results.mddf, xlabel=&quot;d / Å&quot;, ylabel=&quot;mddf(d)&quot;) 
</code></pre><p>results in the expected plot of the MDDF of TMAO as a function of the distance to the protein:</p><center>
<img src="../figures/mddf.png" width="60%">
</center><p>The Kirkwood-Buff integral corresponding to that distribution is provided in the <code>results.kb</code> vector, and can be also directly plotted  with   </p><pre><code class="language-julia hljs">plot(results.d, results.kb, xlabel=&quot;d / Å&quot;, ylabel=&quot;KB(d) / L / mol&quot;) </code></pre><p>to obtain:</p><center>
<img src="../figures/kb.png" width="60%">
</center><p>See the <a href="../contrib/#contributions">Atomic and group contributions</a> section for a detailed account on how to obtain a molecular picture of the solvation by splitting the MDDF in the contributions of each type of atom of the solvent, each type of residue of the protein, etc.</p><h3 id="Save-the-results"><a class="docs-heading-anchor" href="#Save-the-results">Save the results</a><a id="Save-the-results-1"></a><a class="docs-heading-anchor-permalink" href="#Save-the-results" title="Permalink"></a></h3><p>The results can be saved into a file (with JSON format) with:</p><pre><code class="language-julia hljs">save(results, &quot;./results.json&quot;)</code></pre><p>And these results can be loaded afterwards with:</p><pre><code class="language-julia hljs">load(&quot;./results.json&quot;)</code></pre><p>Alternatively, a human-readable set of output files can be obtained to be analyzed in other software (or plotted with alternative tools), with</p><pre><code class="language-julia hljs">write(results,&quot;./results.dat&quot;)</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../parallel/">« Parallel execution</a><a class="docs-footer-nextpage" href="../examples/">Examples: »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.4.0 on <span class="colophon-date" title="Monday 29 April 2024 15:46">Monday 29 April 2024</span>. Using Julia version 1.10.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
