<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>From Python · ComplexMixtures.jl</title><meta name="title" content="From Python · ComplexMixtures.jl"/><meta property="og:title" content="From Python · ComplexMixtures.jl"/><meta property="twitter:title" content="From Python · ComplexMixtures.jl"/><meta name="description" content="Documentation for ComplexMixtures.jl."/><meta property="og:description" content="Documentation for ComplexMixtures.jl."/><meta property="twitter:description" content="Documentation for ComplexMixtures.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img class="docs-light-only" src="../assets/logo.svg" alt="ComplexMixtures.jl logo"/><img class="docs-dark-only" src="../assets/logo-dark.svg" alt="ComplexMixtures.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">ComplexMixtures.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Introduction</a></li><li><a class="tocitem" href="../installation/">Installation</a></li><li><a class="tocitem" href="../parallel/">Parallel execution</a></li><li><a class="tocitem" href="../quickguide/">Quick Guide</a></li><li><a class="tocitem" href="../examples/">Examples:</a></li><li><a class="tocitem" href="../example1/">◦ Protein in water/glycerol</a></li><li><a class="tocitem" href="../example2/">◦ Polyacrylamide in DMF</a></li><li><a class="tocitem" href="../example3/">◦ POPC membrane in water/ethanol</a></li><li><a class="tocitem" href="../example4/">◦ Water/Glycerol mixture</a></li><li><a class="tocitem" href="../selection/">Set solute and solvent</a></li><li><a class="tocitem" href="../trajectory/">Loading the trajectory</a></li><li><a class="tocitem" href="../mddf/">Computing the MDDF</a></li><li><a class="tocitem" href="../results/">Results</a></li><li><a class="tocitem" href="../contributions/">Atomic and group contributions</a></li><li><a class="tocitem" href="../save/">Save and load</a></li><li><a class="tocitem" href="../multiple/">Multiple trajectories</a></li><li><a class="tocitem" href="../options/">Options</a></li><li><a class="tocitem" href="../tools/">Tools</a></li><li class="is-active"><a class="tocitem" href>From Python</a><ul class="internal"><li><a class="tocitem" href="#Loading-the-ComplexMixtures.py-file"><span>Loading the <code>ComplexMixtures.py</code> file</span></a></li><li><a class="tocitem" href="#Installing-juliacall"><span>Installing <code>juliacall</code></span></a></li><li><a class="tocitem" href="#Installing-Julia-and-underlying-packages"><span>Installing Julia and underlying packages</span></a></li><li><a class="tocitem" href="#Example"><span>Example</span></a></li></ul></li><li><a class="tocitem" href="../updating_scripts/">Updating scripts</a></li><li><a class="tocitem" href="../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>From Python</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>From Python</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/m3g/ComplexMixtures.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/m3g/ComplexMixtures.jl/blob/main/docs/src/python.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="python"><a class="docs-heading-anchor" href="#python">From Python</a><a id="python-1"></a><a class="docs-heading-anchor-permalink" href="#python" title="Permalink"></a></h1><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Most features of the package are available through this Python interface. However, some flexibility may be reduced and, also, the tunning of the plot appearance is left to the user, as it is expected that he/she is fluent with some tools within Python if choosing this interface.</p><p>Python 3 or greater is required.</p><p>Please report issues, incompatibilities, or any other difficulty in using the package and its interface.</p></div></div><p>The following examples consider a system composed a protein solvated by a mixture of water and glycerol, built with <a href="http://m3g.iqm.unicamp.br/packmol">Packmol</a>. The simulations were performed with <a href="https://www.ks.uiuc.edu/Research/namd/">NAMD</a> with periodic boundary conditions and a NPT ensemble at room temperature and pressure. Molecular pictures were produced with <a href="https://www.ks.uiuc.edu/Research/vmd/">VMD</a>.</p><center>
<img width=50% src="https://github.com/m3g/ComplexMixturesExamples/raw/main/Protein_in_Glycerol/Data/system.png">
</center><p>Image of the system of the example: a protein solvated by a mixture of glycerol (green) and water, at a concentration of 50%vv.</p><h2 id="Loading-the-ComplexMixtures.py-file"><a class="docs-heading-anchor" href="#Loading-the-ComplexMixtures.py-file">Loading the <code>ComplexMixtures.py</code> file</a><a id="Loading-the-ComplexMixtures.py-file-1"></a><a class="docs-heading-anchor-permalink" href="#Loading-the-ComplexMixtures.py-file" title="Permalink"></a></h2><p>The Python interface of <code>ComplexMixtures</code> is implemented in the <a href="../assets/ComplexMixtures.py"><code>ComplexMixtures.py</code></a> file.  Just download it from the link and save it in a known path.</p><h2 id="Installing-juliacall"><a class="docs-heading-anchor" href="#Installing-juliacall">Installing <code>juliacall</code></a><a id="Installing-juliacall-1"></a><a class="docs-heading-anchor-permalink" href="#Installing-juliacall" title="Permalink"></a></h2><p><a href="https://github.com/cjdoris/PythonCall.jl"><code>juliacall</code></a> is a package that allows calling Julia programs from Python. Install it with</p><pre><code class="language-bash hljs">pip install juliacall</code></pre><h2 id="Installing-Julia-and-underlying-packages"><a class="docs-heading-anchor" href="#Installing-Julia-and-underlying-packages">Installing Julia and underlying packages</a><a id="Installing-Julia-and-underlying-packages-1"></a><a class="docs-heading-anchor-permalink" href="#Installing-Julia-and-underlying-packages" title="Permalink"></a></h2><p>Once <code>juliacall</code> is installed, from within Python, execute:</p><pre><code class="language-python hljs">import ComplexMixtures</code></pre><p>here we assume that the <a href="../assets/ComplexMixtures.py"><code>ComplexMixtures.py</code></a> file is in the same directory where you launched Python.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p><strong>On the first</strong> time you execute this command, the Julia executable and the required Julia packages (<code>ComplexMixtures</code> and <code>PDBTools</code>) will be downloaded and installed. At the end of the process quit Python (not really required, but we prefer to separate the installation from the use of the module). </p></div></div><h2 id="Example"><a class="docs-heading-anchor" href="#Example">Example</a><a id="Example-1"></a><a class="docs-heading-anchor-permalink" href="#Example" title="Permalink"></a></h2><h3 id="Index"><a class="docs-heading-anchor" href="#Index">Index</a><a id="Index-1"></a><a class="docs-heading-anchor-permalink" href="#Index" title="Permalink"></a></h3><ul><li><a href="#data-pythonexample">Data, packages, and execution</a></li><li><a href="#script1-python">Minimum-Distance Distribution function</a></li><li><a href="#python-plotting1">MDDF and KB integrals</a></li><li><a href="#python-plotting2">Atomic contributions to the MDDF</a></li></ul><h3 id="data-pythonexample"><a class="docs-heading-anchor" href="#data-pythonexample">Data, packages, and execution</a><a id="data-pythonexample-1"></a><a class="docs-heading-anchor-permalink" href="#data-pythonexample" title="Permalink"></a></h3><p>The files required to run this example are:</p><ul><li><a href="https://raw.githubusercontent.com/m3g/ComplexMixturesExamples/main/Protein_in_Glycerol/Data/system.pdb">system.pdb</a>: The PDB file of the complete system.</li><li><a href="https://www.dropbox.com/scl/fi/n3gtyotavo00jtz8bajti/glyc50_sample.dcd?rlkey=5ax8t4w7e0dr5w0n5g797p02j&amp;dl=0">glyc50_sample.dcd</a>: A 30Mb sample trajectory file. The <a href="https://www.dropbox.com/scl/fi/zfq4o21dkttobg2pqd41m/glyc50_traj.dcd?rlkey=el3k6t0fx6w5yiqktyx96gzg6&amp;dl=0">full trajectory</a> can also be used, but it is a 1GB file.</li></ul><p>To start, create a directory and copy the <a href="../assets/ComplexMixtures.py"><code>ComplexMixtures.py</code></a> file to it. Navigate into this directory, and, to start, set the number of threads that Julia will use, to run the calculations in parallel. Typically, in <code>bash</code>, this means defining teh following environment variable:</p><pre><code class="language-bash hljs">export JULIA_NUM_THREADS=8</code></pre><p>where <code>8</code> is the number of CPU cores available in your computer. For further information about Julia multi-threading, and on setting this environment variable in other systems, please read <a href="https://docs.julialang.org/en/v1/manual/multi-threading/#Starting-Julia-with-multiple-threads">this section</a> of the Julia manual.</p><p>Finally, each script can be executed with, for example:</p><pre><code class="language-bash hljs">python3 script.py</code></pre><h3 id="script1-python"><a class="docs-heading-anchor" href="#script1-python">Minimum-Distance Distribution function</a><a id="script1-python-1"></a><a class="docs-heading-anchor-permalink" href="#script1-python" title="Permalink"></a></h3><details><summary><font color="darkgreen">Complete example code: click here!</font></summary><pre><code class="language-python hljs"># The ComplexMixtures.py file is assumed to be in the current
# directory.
# Obtain it from: 
# https://m3g.github.io/ComplexMixtures.jl/stable/assets/ComplexMixtures.py 
import ComplexMixtures as cm

# Load the pdb file of the system using `PDBTools`:
atoms = cm.readPDB(&quot;./system.pdb&quot;)

# Create arrays of atoms with the protein and Glycerol atoms, 
# using the `select` function of the `PDBTools` package:
protein = cm.select(atoms,&quot;protein&quot;)
glyc = cm.select(atoms,&quot;resname GLYC&quot;)
water = cm.select(atoms,&quot;water&quot;)

# Setup solute and solvent structures, required for computing the MDDF, 
# with `AtomSelection` function of the `ComplexMixtures` package:
solute = cm.AtomSelection(protein, nmols=1)
solvent = cm.AtomSelection(glyc, natomspermol=14)

# Read and setup the Trajectory structure required for the computations:
trajectory = cm.Trajectory(&quot;./glyc50_sample.dcd&quot;, solute, solvent)

# Run the calculation and get results:
results = cm.mddf(trajectory)

# Save the reults to recover them later if required
cm.save(results,&quot;./glyc50.json&quot;)
print(&quot;Results saved to glyc50.json&quot;)

# Compute the water distribution function around the protein:
solvent = cm.AtomSelection(water, natomspermol=3)
trajectory = cm.Trajectory(&quot;./glyc50_sample.dcd&quot;, solute, solvent)
results = cm.mddf(trajectory)
cm.save(results,&quot;./water.json&quot;)
print(&quot;Results saved to water.json&quot;)</code></pre></details><br><p>Note that the example here follows an identical syntax to the Julia example, except that we qualify the name of the loaded module and implicitly load the <code>PDBTools</code> package.</p><p>The script to compute the MDDFs as associated data from within python is, then:</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>To change the options of the calculation, set the <code>Options</code> structure accordingly and pass it as a parameter to <code>mddf</code>. For example:</p><pre><code class="language-python hljs">options = cm.Options(bulk_range=(8.0, 12.0))
results = cm.mddf(trajectory, options)</code></pre><p>The complete set of options available is described <a href="../options/#options">here</a>.</p></div></div><p>The trajectory that was loaded was for a toy-example. The complete trajectory is available <a href="https://drive.google.com/file/d/14M30jDHRwUM77hzbDphgbu8mcWFBcQrX/view?usp=sharing">here</a>, but it is a 3GB file. The same procedure above was performed with that file and produced the <code>results_Glyc50.json</code> file, which is available in the Data directory here. We will continue with this file instead. </p><h3 id="python-plotting1"><a class="docs-heading-anchor" href="#python-plotting1">MDDF and KB integrals</a><a id="python-plotting1-1"></a><a class="docs-heading-anchor-permalink" href="#python-plotting1" title="Permalink"></a></h3><p>The following python script will produce the typical MDDF and KB integral plot, for the sample system. The noise in the figures is because the trajectory sample is small.</p><details><summary><font color="darkgreen">Complete example code: click here!</font></summary><pre><code class="language-python hljs">import ComplexMixtures as cm
import matplotlib.pyplot as plt

# Load the actual results obtained with the complete simulation:
glyc_results = cm.load(&quot;./glyc50.json&quot;)
water_results = cm.load(&quot;./water.json&quot;)

# Plot MDDF and KB
fig, axs = plt.subplots(2)
axs[0].plot(glyc_results.d, glyc_results.mddf, label=&quot;Glycerol&quot;)
axs[0].plot(water_results.d, water_results.mddf, label=&quot;Water&quot;)
axs[0].set(ylabel=&quot;MDDF&quot;)

# Plot KB integral
axs[1].plot(glyc_results.d, glyc_results.kb)
axs[1].plot(water_results.d, water_results.kb)
axs[1].set(xlabel=&quot;distance / Angs&quot;, ylabel=&quot;KB integral&quot;)
plt.tight_layout()

plt.savefig(&quot;mddf_kb.png&quot;)</code></pre></details><br><p><img src="../assets/scripts/python/mddf_kb.png" alt/></p><p>In the top plot, we see that glycerol and water display clear solvation shells around the protein, with glycerol having a greater peak. This accumulation leads to a greater (less negative) KB integral for glycerol than water, as shown in the second plot. This indicates that the protein is preferentially solvated by glycerol in this system (assuming that sampling is adequate in this small trajectory).</p><h3 id="python-plotting2"><a class="docs-heading-anchor" href="#python-plotting2">Atomic contributions to the MDDF</a><a id="python-plotting2-1"></a><a class="docs-heading-anchor-permalink" href="#python-plotting2" title="Permalink"></a></h3><p>The following script produces a plot of the group contributions of Glycerol to the total MDDF function. The Glycerol MDDF is split into the contributions of the hydroxyl and aliphatic groups.</p><details><summary><font color="darkgreen">Complete example code: click here!</font></summary><pre><code class="language-python hljs"># Load packages
import ComplexMixtures as cm
import matplotlib.pyplot as plt

# Read the pdb file and set solvent and solute groups
atoms = cm.readPDB(&quot;./system.pdb&quot;)
protein = cm.select(atoms, &quot;protein&quot;)
glyc = cm.select(atoms, &quot;resname GLYC&quot;)

# load previously computed MDDF results
results = cm.load(&quot;./glyc50.json&quot;)

# Select atoms by name
hydroxyls = cm.list([&quot;O1&quot;,&quot;O2&quot;,&quot;O3&quot;,&quot;H1&quot;,&quot;H2&quot;,&quot;H3&quot;])
aliphatic = cm.list([&quot;C1&quot;,&quot;C2&quot;,&quot;HA&quot;,&quot;HB&quot;,&quot;HC&quot;,&quot;HD&quot;])

# Extract the contributions of the Glycerol hydroxyls and aliphatic groups
hydr_contributions = cm.contributions(results, cm.SolventGroup(hydroxyls))
aliph_contributions = cm.contributions(results, cm.SolventGroup(aliphatic))

# Plot
plt.plot(results.d, results.mddf, label=&quot;Total MDDF&quot;)
plt.plot(results.d, hydr_contributions, label=&quot;Hydroxyls&quot;)
plt.plot(results.d, aliph_contributions, label=&quot;Aliphatic&quot;)
plt.legend()
plt.xlabel(&quot;distance / Angs&quot;)
plt.ylabel(&quot;MDDF&quot;)
plt.savefig(&quot;group_contributions.png&quot;)</code></pre></details><br><p><img src="../assets/scripts/python/group_contributions.png" alt/></p><p>Despite the low sampling, it is clear that hydroxyl groups contribute to the greter peak of the distribution, at hydrogen-bonding distances, as expected. The contributions of the aliphatic groups to the MDDF occurs at longer distances, associated to non-specific interactions. </p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The syntax here diverges from the Julia-only examples by requiring the lists of names to be converted to Julia arrays, which happens by using the <code>cm.list(python_list)</code> function calls.</p></div></div></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../tools/">« Tools</a><a class="docs-footer-nextpage" href="../updating_scripts/">Updating scripts »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Friday 18 October 2024 15:44">Friday 18 October 2024</span>. Using Julia version 1.11.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
