<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Full Example · ComplexMixtures.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img class="docs-light-only" src="../assets/logo.svg" alt="ComplexMixtures.jl logo"/><img class="docs-dark-only" src="../assets/logo-dark.svg" alt="ComplexMixtures.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">ComplexMixtures.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Introduction</a></li><li><a class="tocitem" href="../installation/">Installation</a></li><li><a class="tocitem" href="../parallel/">Parallel execution</a></li><li><a class="tocitem" href="../quickguide/">Quick Guide</a></li><li class="is-active"><a class="tocitem" href>Full Example</a><ul class="internal"><li><a class="tocitem" href="#How-to-run-this-example"><span>How to run this example</span></a></li><li><a class="tocitem" href="#Data"><span>Data</span></a></li><li><a class="tocitem" href="#Minimum-Distance-Distribuion-function"><span>Minimum-Distance Distribuion function</span></a></li><li><a class="tocitem" href="#D-residue-contribution-density-map"><span>2D residue contribution density map</span></a></li><li class="toplevel"><a class="tocitem" href="#D-residue-contribution-density-map-2"><span>3D residue contribution density map</span></a></li></ul></li><li><a class="tocitem" href="../selection/">Set solute and solvent</a></li><li><a class="tocitem" href="../trajectory/">Loading the trajectory</a></li><li><a class="tocitem" href="../mddf/">Computing the MDDF</a></li><li><a class="tocitem" href="../results/">Results</a></li><li><a class="tocitem" href="../contrib/">Atomic and group contributions</a></li><li><a class="tocitem" href="../save/">Save and load</a></li><li><a class="tocitem" href="../multiple/">Multiple trajectories</a></li><li><a class="tocitem" href="../options/">Options</a></li><li><a class="tocitem" href="../tools/">Tools</a></li><li><a class="tocitem" href="../help/">Help entries</a></li><li><a class="tocitem" href="../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Full Example</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Full Example</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/m3g/ComplexMixtures.jl/blob/main/docs/src/examples.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="examples"><a class="docs-heading-anchor" href="#examples">Example</a><a id="examples-1"></a><a class="docs-heading-anchor-permalink" href="#examples" title="Permalink"></a></h1><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>At <a href="https://github.com/m3g/ComplexMixturesExamples">this repository</a> various examples are available illustrating the execution and possibilities of the package. Here we discuss one of these examples in detail.</p></div></div><p>The following examples consider a system composed a protein solvated by a mixture of water and glycerol, built with <a href="http://m3g.iqm.unicamp.br/packmol">Packmol</a>. The simulations were performed with <a href="https://www.ks.uiuc.edu/Research/namd/">NAMD</a> with periodic boundary conditions and a NPT ensemble at room temperature and pressure. Molecular pictures were produced with <a href="https://www.ks.uiuc.edu/Research/vmd/">VMD</a> and plots were produced with <a href="https://julialang.org">Julia</a>&#39;s <a href="http://docs.juliaplots.org/latest/">Plots</a> library.</p><center>
<img width=50% src="https://github.com/m3g/ComplexMixturesExamples/raw/main/Protein_in_Glycerol/Data/system.png">
</center><p>Image of the system of the example: a protein solvated by a mixture of glycreol (green) and water, at a concentration of 50%vv. </p><h2 id="How-to-run-this-example"><a class="docs-heading-anchor" href="#How-to-run-this-example">How to run this example</a><a id="How-to-run-this-example-1"></a><a class="docs-heading-anchor-permalink" href="#How-to-run-this-example" title="Permalink"></a></h2><ul><li><p>Download and install <a href="https://julialang.org">Julia</a></p></li><li><p>Install the required packages. Within Julia, do:</p></li></ul><pre><code class="language-julia-repl hljs">julia&gt; import Pkg

julia&gt; Pkg.add([&quot;ComplexMixtures&quot;, &quot;PDBTools&quot;, &quot;Plots&quot;, &quot;LaTeXStrings&quot;, &quot;Formatting&quot;])</code></pre><ul><li>Get the files:</li></ul><pre><code class="language-bash hljs">git clone https://github.com/m3g/ComplexMixturesExamples</code></pre><p>The files associated to the following examples are distributed at <a href="https://github.com/m3g/ComplexMixturesExamples/tree/main/Protein_in_Glycerol">this page</a>. </p><h2 id="Data"><a class="docs-heading-anchor" href="#Data">Data</a><a id="Data-1"></a><a class="docs-heading-anchor-permalink" href="#Data" title="Permalink"></a></h2><p>The <a href="https://github.com/m3g/ComplexMixturesExamples/tree/main/Protein_in_Glycerol/Data">Data</a> directory contains the a pdb file of the system (<code>system.pdb</code>) and a sample from the trajectory (<code>glyc50.dcd</code>), with a few frames. It also contains the result of running the <code>mddf</code> calculation on the complete trajectory, <code>results_glyc50.json</code>. This last file was produced by <code>ComplexMixtures</code>, as indicated in the following examples. </p><p>The sample trajectory is provided so that the first example can be run, yet do not expect that the results are the same, as the sampling is much lower in this case. The complete trajectory can be retrieved from <a href="https://drive.google.com/file/d/14M30jDHRwUM77hzbDphgbu8mcWFBcQrX/view?usp=sharing">this link</a> (3GB file). </p><h2 id="Minimum-Distance-Distribuion-function"><a class="docs-heading-anchor" href="#Minimum-Distance-Distribuion-function">Minimum-Distance Distribuion function</a><a id="Minimum-Distance-Distribuion-function-1"></a><a class="docs-heading-anchor-permalink" href="#Minimum-Distance-Distribuion-function" title="Permalink"></a></h2><p>Here we compute the minimum-distance distribution function, the Kirkwood-Buff integral, and the atomic contributions of the solvent to the density.</p><p>This example illustrates the regular usage of <code>ComplexMixtures</code>, to compute the minimum distance distribution function, KB-integrals and group contributions. </p><h3 id="How-to-run-this-example-2"><a class="docs-heading-anchor" href="#How-to-run-this-example-2">How to run this example</a><a class="docs-heading-anchor-permalink" href="#How-to-run-this-example-2" title="Permalink"></a></h3><pre><code class="language-bash hljs">cd ComplexMixturesExamples/Protein_in_Glycerol/MDDF
julia -t auto mddf.jl</code></pre><h3 id="Detailed-explanation-of-the-example:"><a class="docs-heading-anchor" href="#Detailed-explanation-of-the-example:">Detailed explanation of the example:</a><a id="Detailed-explanation-of-the-example:-1"></a><a class="docs-heading-anchor-permalink" href="#Detailed-explanation-of-the-example:" title="Permalink"></a></h3><p>Loading the packages required for computing the MDDF.  </p><pre><code class="language-julia hljs">using PDBTools
using ComplexMixtures</code></pre><p>Load the pdb file of the system using <code>PDBTools</code>:</p><pre><code class="language-julia hljs">atoms = readPDB(&quot;../Data/system.pdb&quot;)</code></pre><p>Create arrays of atoms with the protein and Glycerol atoms, using the <code>select</code> function of the <code>PDBTools</code> package:</p><pre><code class="language-julia hljs">protein = select(atoms,&quot;protein&quot;)
glyc = select(atoms,&quot;resname GLYC&quot;)</code></pre><p>Setup solute and solvent structures, required for computing the MDDF, with <code>Selection</code> function of the <code>ComplexMixtures</code> package:</p><pre><code class="language-julia hljs">solute = Selection(protein,nmols=1)
solvent = Selection(glyc,natomspermol=14)</code></pre><p>Read and setup the Trajectory structure required for the computations:</p><pre><code class="language-julia hljs">trajectory = Trajectory(&quot;../Data/glyc50_complete.dcd&quot;,solute,solvent)</code></pre><p>Run the calculation and get results:</p><pre><code class="language-julia hljs">results = mddf(trajectory)</code></pre><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>To change the options of the calculation, set the <code>Options</code> structure accordingly and pass it as a parameter to <code>mddf</code>. For example:</p><pre><code class="language-julia hljs">options = Options(cutoff=10.)
mddf(trajectory,options)</code></pre><p>The complete set of options available is described <a href="../options/#options">here</a>.</p></div></div><p>Save the reults to recover them later if required</p><pre><code class="language-julia hljs">save(results,&quot;./glyc50.json&quot;)</code></pre><p>The trajectory that was loaded was for a toy-example. The complete trajectory is available <a href="https://drive.google.com/file/d/14M30jDHRwUM77hzbDphgbu8mcWFBcQrX/view?usp=sharing">here</a>, but it is a 3GB file. The same procedure above was performed with that file and produced the <code>results_Glyc50.json</code> file, which is available in the Data directory here. We will continue with this file instead. </p><p>Load the actual results obtained with the complete simulation:</p><pre><code class="language-julia hljs">results = load(&quot;../Data/results_glyc50.json&quot;)</code></pre><p>Results are loaded, and now we can plot the data obtained.</p><h3 id="Produce-plots"><a class="docs-heading-anchor" href="#Produce-plots">Produce plots</a><a id="Produce-plots-1"></a><a class="docs-heading-anchor-permalink" href="#Produce-plots" title="Permalink"></a></h3><h4 id="MDDF-and-Kirkwood-Buff-integrals"><a class="docs-heading-anchor" href="#MDDF-and-Kirkwood-Buff-integrals">MDDF and Kirkwood-Buff integrals</a><a id="MDDF-and-Kirkwood-Buff-integrals-1"></a><a class="docs-heading-anchor-permalink" href="#MDDF-and-Kirkwood-Buff-integrals" title="Permalink"></a></h4><p>Load some packages that we will use to produce the plots:</p><pre><code class="language-julia hljs">using Plots, Plots.PlotMeasures, LaTeXStrings</code></pre><p>Some default options that make the plots prettier:</p><pre><code class="language-julia hljs">default(
    fontfamily=&quot;Computer Modern&quot;,
    linewidth=2, framestyle=:box, label=nothing, grid=false
)</code></pre><p>First, we will plot the MDDF and the corresponding Kirkwood-Buff integral, which are available in the <code>results.mddf</code> and <code>results.kb</code> fields of the <code>results</code> data set. The distances are available in the <code>results.d</code> vector. We also plot here an horizontal line and save the figure as a <code>pdf</code> file.  </p><pre><code class="language-julia hljs">plot(layout=(1,2))
plot!(results.d,results.mddf,xlabel=L&quot;r/\AA&quot;,ylabel=&quot;mddf&quot;,subplot=1)
hline!([1],linestyle=:dash,linecolor=:gray,subplot=1)
plot!(
    results.d,results.kb/1000, #to L/mol
    xlabel=L&quot;r/\AA&quot;,ylabel=L&quot;G_{us}/\mathrm{L~mol^{-1}}&quot;,
    subplot=2
)
plot!(size=(800,300),margin=4mm)
savefig(&quot;./mddf.pdf&quot;)</code></pre><p>This will produce the following plot:</p><center>
<img width=100% src="https://github.com/m3g/ComplexMixturesExamples/raw/main/Protein_in_Glycerol/MDDF/mddf.png">
</center><h3 id="Atomic-contributions-to-the-MDDF"><a class="docs-heading-anchor" href="#Atomic-contributions-to-the-MDDF">Atomic contributions to the MDDF</a><a id="Atomic-contributions-to-the-MDDF-1"></a><a class="docs-heading-anchor-permalink" href="#Atomic-contributions-to-the-MDDF" title="Permalink"></a></h3><p>Selecting the atoms corresponding to the hydroxyl groups, and of the aliphatic carbons of Glycerol. Here we list the types of the atoms as specified by the force-field.</p><pre><code class="language-julia hljs">hydroxyls = [&quot;O1&quot;,&quot;O2&quot;,&quot;O3&quot;,&quot;H1&quot;,&quot;H2&quot;,&quot;H3&quot;]
aliphatic = [&quot;C1&quot;,&quot;C2&quot;,&quot;HA&quot;,&quot;HB&quot;,&quot;HC&quot;,&quot;HD&quot;]</code></pre><p>The <code>contrib</code> function of <code>ComplexMixtures</code> will extract from the result the contributions of each set of atoms to the total MDDF:</p><pre><code class="language-julia hljs">hydr_contrib = contrib(solvent,results.solvent_atom,hydroxyls)
aliph_contrib = contrib(solvent,results.solvent_atom,aliphatic)</code></pre><p>And, finally, here we plot these group contributions on top of the total MDDF:</p><pre><code class="language-julia hljs">plot(results.d,results.mddf,xlabel=L&quot;r/\AA&quot;,ylabel=&quot;mddf&quot;,size=(600,400))
plot!(results.d,hydr_contrib,label=&quot;Hydroxils&quot;)
plot!(results.d,aliph_contrib,label=&quot;Aliphatic chain&quot;)
hline!([1],linestyle=:dash,linecolor=:gray)
savefig(&quot;./mddf_atom_contrib.pdf&quot;)</code></pre><p>This will produce the following figure:</p><center>
<img width=70% src="https://github.com/m3g/ComplexMixturesExamples/raw/main/Protein_in_Glycerol/MDDF/mddf_atom_contrib.png">
</center><p>Note how hydroxyl clearly are the sole contribution to the peak at ~1.9 Angstroms, corresponding to hydrogen-bonding interactions. The aliphatic groups contribute importantly to the shoulder at larger distances, which correspond to non-specific interactions. </p><h2 id="D-residue-contribution-density-map"><a class="docs-heading-anchor" href="#D-residue-contribution-density-map">2D residue contribution density map</a><a id="D-residue-contribution-density-map-1"></a><a class="docs-heading-anchor-permalink" href="#D-residue-contribution-density-map" title="Permalink"></a></h2><p>In this example we compute the density map of Glycerol in the vicinity of a set of residues of a protein, from the minimum-distance distribution function. </p><p>The MDDF can be decomposed in the contributions of each atom of the solute or of the solvent. Here, we sum up te contributions of all the atoms of each residue of the solute, which is a protein, and plot a density map with the final information. The output figure obtained is:</p><center>
<img width=70% src="https://github.com/m3g/ComplexMixturesExamples/raw/main/Protein_in_Glycerol/Density2D/density2D.png">
</center><h3 id="How-to-run-this-example:"><a class="docs-heading-anchor" href="#How-to-run-this-example:">How to run this example:</a><a id="How-to-run-this-example:-1"></a><a class="docs-heading-anchor-permalink" href="#How-to-run-this-example:" title="Permalink"></a></h3><pre><code class="language-bash hljs">cd ComplexMixturesExamples/Protein_in_Glycerol/Density2D
julia density2D.jl</code></pre><h3 id="Detailed-explanation-of-the-example:-2"><a class="docs-heading-anchor" href="#Detailed-explanation-of-the-example:-2">Detailed explanation of the example:</a><a class="docs-heading-anchor-permalink" href="#Detailed-explanation-of-the-example:-2" title="Permalink"></a></h3><p>Here, we use the <code>contourf</code> function of the <code>Plots</code> package of Julia. A detailed explanation of the input file <code>density2D.jl</code> is provide below: </p><h3 id="Loading-packages-that-will-be-used:"><a class="docs-heading-anchor" href="#Loading-packages-that-will-be-used:">Loading packages that will be used:</a><a id="Loading-packages-that-will-be-used:-1"></a><a class="docs-heading-anchor-permalink" href="#Loading-packages-that-will-be-used:" title="Permalink"></a></h3><pre><code class="language-julia hljs">using Plots
using LaTeXStrings
using Formatting
using ComplexMixtures, PDBTools</code></pre><h3 id="Some-default-options-so-the-plot-looks-nice"><a class="docs-heading-anchor" href="#Some-default-options-so-the-plot-looks-nice">Some default options so the plot looks nice</a><a id="Some-default-options-so-the-plot-looks-nice-1"></a><a class="docs-heading-anchor-permalink" href="#Some-default-options-so-the-plot-looks-nice" title="Permalink"></a></h3><pre><code class="language-julia hljs">plot_font = &quot;Computer Modern&quot;
default(
    fontfamily=plot_font,
    linewidth=2, framestyle=:box, label=nothing
)</code></pre><h3 id="Read-the-PDB-file-(using-PDBTools)"><a class="docs-heading-anchor" href="#Read-the-PDB-file-(using-PDBTools)">Read the PDB file (using PDBTools)</a><a id="Read-the-PDB-file-(using-PDBTools)-1"></a><a class="docs-heading-anchor-permalink" href="#Read-the-PDB-file-(using-PDBTools)" title="Permalink"></a></h3><pre><code class="language-julia hljs">pdb = readPDB(&quot;./system.pdb&quot;)</code></pre><h3 id="Load-results-of-the-ComplexMixtures-run"><a class="docs-heading-anchor" href="#Load-results-of-the-ComplexMixtures-run">Load results of the ComplexMixtures run</a><a id="Load-results-of-the-ComplexMixtures-run-1"></a><a class="docs-heading-anchor-permalink" href="#Load-results-of-the-ComplexMixtures-run" title="Permalink"></a></h3><pre><code class="language-julia hljs">R = load(&quot;./results_glyc50.json&quot;)  </code></pre><h3 id="Define-which-are-the-solute-molecules-(the-protein)"><a class="docs-heading-anchor" href="#Define-which-are-the-solute-molecules-(the-protein)">Define which are the solute molecules (the protein)</a><a id="Define-which-are-the-solute-molecules-(the-protein)-1"></a><a class="docs-heading-anchor-permalink" href="#Define-which-are-the-solute-molecules-(the-protein)" title="Permalink"></a></h3><pre><code class="language-julia hljs">protein = select(pdb,&quot;protein&quot;)
solute = Selection(protein,nmols=1)</code></pre><h3 id="Define-which-are-the-solvent-molecules-(Glycerol-here)"><a class="docs-heading-anchor" href="#Define-which-are-the-solvent-molecules-(Glycerol-here)">Define which are the solvent molecules (Glycerol here)</a><a id="Define-which-are-the-solvent-molecules-(Glycerol-here)-1"></a><a class="docs-heading-anchor-permalink" href="#Define-which-are-the-solvent-molecules-(Glycerol-here)" title="Permalink"></a></h3><pre><code class="language-julia hljs">glycerol = select(pdb,&quot;resname GLYC&quot;)
solvent = Selection(glycerol,natomspermol=14)</code></pre><h3 id="Retrive-the-resiude-contribution-data"><a class="docs-heading-anchor" href="#Retrive-the-resiude-contribution-data">Retrive the resiude contribution data</a><a id="Retrive-the-resiude-contribution-data-1"></a><a class="docs-heading-anchor-permalink" href="#Retrive-the-resiude-contribution-data" title="Permalink"></a></h3><p>Collect which are the protein residues </p><pre><code class="language-julia hljs">residues = collect(eachresidue(protein))</code></pre><p>Set a matrix that will store the results, with a number of lines corresponding to the length of the MDDF histogram, and with a number of columns corresponding to the number of residues:</p><pre><code class="language-julia hljs">rescontrib = zeros(length(R.mddf),length(residues))</code></pre><p>Now, collect the contribution of each residue as a column of the above matrix. The notation <code>pairs(residues)</code> returns tuples containg the index <code>ires</code> and the corresponding residue. The <code>.=</code> symbol sets each element of the corresponding column of the  <code>rescontrib</code> matrix to the output of <code>contrib</code> (by broadcasting).  </p><pre><code class="language-julia hljs">for (ires,residue) in pairs(residues)
  rescontrib[:,ires] .= contrib(solute,R.solute_atom,residue)
end</code></pre><h3 id="Plot-only-for-distances-within-1.5-and-3.5:"><a class="docs-heading-anchor" href="#Plot-only-for-distances-within-1.5-and-3.5:">Plot only for distances within 1.5 and 3.5:</a><a id="Plot-only-for-distances-within-1.5-and-3.5:-1"></a><a class="docs-heading-anchor-permalink" href="#Plot-only-for-distances-within-1.5-and-3.5:" title="Permalink"></a></h3><p>Here, we will plot only the contributions from residue <code>70</code> to residue <code>110</code>, and from distances ranging from <code>1.5</code> to <code>3.5</code> which is where most of the action occurs:</p><pre><code class="language-julia hljs">irange=70:110
idmin = findfirst( d -&gt; d &gt; 1.5, R.d)
idmax = findfirst( d -&gt; d &gt; 3.5, R.d)</code></pre><p>To obtain pretty labels for the residues in the x-axis, we retrieve the one-letter residue names and concatenate them with the residue number converted to strings:</p><pre><code class="language-julia hljs">labels = PDBTools.oneletter.(resname.(residues)).*format.(resnum.(residues))</code></pre><p>And, finally, we produce the plot, with a series of options that make this particular contour plot look nice:</p><pre><code class="language-julia hljs">contourf(
    irange, # x
    R.d[idmin:idmax], # y
    rescontrib[idmin:idmax,irange], # z
    xlabel=&quot;Residue&quot;, ylabel=L&quot;r/\AA&quot;,
    xticks=(irange,labels[irange]), xrotation=60,
    xtickfont=font(6,plot_font),
    color=cgrad(:tempo), linewidth=0.1, linecolor=:black,
    colorbar=:none, levels=5,
    size=(500,280)
)</code></pre><p>The final figure is saved as a <code>pdf</code> file:</p><pre><code class="language-julia hljs">savefig(&quot;./density2D.pdf&quot;)</code></pre><h1 id="D-residue-contribution-density-map-2"><a class="docs-heading-anchor" href="#D-residue-contribution-density-map-2">3D residue contribution density map</a><a class="docs-heading-anchor-permalink" href="#D-residue-contribution-density-map-2" title="Permalink"></a></h1><p>In this example we compute three-dimensional representations of the density map of Glycerol in the vicinity of a set of residues of a protein, from the minimum-distance distribution function. </p><p>Here, the MDDF is decomposed at each distance according to the contributions of each <em>solute</em> (the protein) residue. The grid is created such that, at each point in space around the protein, it is possible to identify: </p><ol><li><p>Which atom is the closest atom of the solute to that point.</p></li><li><p>Which is the contribution of that atom (or residue) to the distribution function.</p></li></ol><p>Therefore, by filtering the 3D density map at each distance one can visualize over the solute structure which are the regions that mostly interact with the solvent of choice at each distance. Typical images of such a density are:</p><center>
<img width=100% src="https://github.com/m3g/ComplexMixturesExamples/raw/main/Protein_in_Glycerol/Density3D/density3D_final.png">
</center><p>In the figure on the left, the points in space around the protein are selected with the following properties: distance from the protein smaller than 2.0Å and relative contribution to the MDDF at the corresponding distance of at least 10% of the maximum contribution. Thus, we are selecting the regions of the protein corresponding to the most stable hydrogen-bonding interactions. The color of the points is the contribution to the MDDF, from blue to red. Thus, the most reddish-points corresponds to the regions where the most stable hydrogen bonds were formed. We have marked two regions here, on opposite sides of the protein, with arrows.</p><p>Clicking on those points we obtain which are the atoms of the protein contributing to the MDDF at that region. In particular, the arrow on the right points to the strongest red region, which corresponds to an Aspartic acid. These residues are shown explicitly under the density (represented as a transparent surface) on the figure in the center.</p><p>The figure on the right displays, overlapped with the hydrogen-bonding residues, the most important contributions to the second peak of the distribution, corresponding to distances from the protein between 2.0 and 3.5Å. Notably, the regions involved are different from the ones forming hydrogen bonds, indicating that non-specific interactions with the protein (and not a second solvation shell) are responsible for the second peak. </p><p>A short tutorial video showing how to open the input and output PDB files in VMD and produce images of the density is available here: </p><center>
<iframe width="560" style="height:315px" src="https://www.youtube.com/embed/V4Py44IKDh8" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
</center><h3 id="How-to-run-this-example:-2"><a class="docs-heading-anchor" href="#How-to-run-this-example:-2">How to run this example:</a><a class="docs-heading-anchor-permalink" href="#How-to-run-this-example:-2" title="Permalink"></a></h3><pre><code class="language-bash hljs">cd ComplexMixturesExamples/Protein_in_Glycerol/Density3D
julia density3D.jl</code></pre><p>Alternatively, open Julia and copy/paste or the commands in <code>density3D.jl</code> or use <code>include(&quot;./density3D.jl&quot;)</code>. These options will allow you to remain on the Julia section with access to the <code>grid</code> data structure that was generated and corresponds to the output <code>grid.pdb</code> file. </p><p>This will create (actually overwrite) the <code>grid.pdb</code> file. Here we provide a previously setup VMD session that contains the data with the visualization choices used to generate the figure above. Load it with:</p><pre><code class="language-bash hljs">vmd -e grid.vmd</code></pre><h3 id="Detailed-explanation-of-the-example:-3"><a class="docs-heading-anchor" href="#Detailed-explanation-of-the-example:-3">Detailed explanation of the example:</a><a class="docs-heading-anchor-permalink" href="#Detailed-explanation-of-the-example:-3" title="Permalink"></a></h3><p>Initially we load the <code>ComplexMixtures</code> and <code>PDBTools</code> packages:</p><pre><code class="language-julia hljs">using ComplexMixtures, PDBTools</code></pre><p>With the <code>readPDB</code> function of <code>PDBTools</code>, we read the  PDB file of the system simulated:</p><pre><code class="language-julia hljs">pdb = readPDB(&quot;../Data/system.pdb&quot;)</code></pre><p>and using <code>ComplexMixtures</code>, we load the results from the calculation of the MDDF of Glycerol around the protein, which was computed previously:</p><pre><code class="language-julia hljs">R = load(&quot;../Data/results_glyc50.json&quot;)  </code></pre><p>The solute here is the protein, and we need to setup the structures that define which atoms and type of solute it is. First, we select from the atoms of the pdb file of the system, those belonging to the protein, using <code>select</code> from <code>PDBTools</code>:</p><pre><code class="language-julia hljs">protein = select(pdb,&quot;protein&quot;)</code></pre><p>and then we define the solute structure that is actually used in <code>ComplexMixtures</code>, by passing those atoms and specifying that the solute is a single molecule to the <code>Selection</code> function of <code>ComplexMixtures</code>:</p><pre><code class="language-julia hljs">solute = Selection(protein,nmols=1)</code></pre><p>The 3D grid representing the density around the protein is computed with the <code>grid3D</code> function provided by <code>ComplexMixtures</code>. It receives the <code>solute</code> structure (of type <code>Selection</code>), the list of solute atoms (of type <code>PDBTools.Atoms</code>, as the <code>protein</code> selection above), the name of the output file and some optional parameters to define the grid. Here we compute the grid only between 1.5 and 3.5Å, characterizing the first and second solvation shells. The grid has by default a <code>step</code> of 0.5Å. </p><pre><code class="language-julia hljs">grid = grid3D(
    solute=solute,
    solute_atoms=protein,
    mddf_result=R,
    output_file=&quot;grid.pdb&quot;,
    dmin=1.5,
    dmax=3.5
)</code></pre><p>The command above will generate the grid, save it to <code>grid.pdb</code> and let it available in the <code>grid.pdb</code> array of atoms, for further inspection, if desired. </p><p>By changing <code>dmin</code>, <code>dmax</code>, and <code>step</code>, one controls the grid size and resolution. This may generate very large output files.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../quickguide/">« Quick Guide</a><a class="docs-footer-nextpage" href="../selection/">Set solute and solvent »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Tuesday 18 April 2023 18:14">Tuesday 18 April 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
