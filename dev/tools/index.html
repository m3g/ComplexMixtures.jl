<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Tools · ComplexMixtures.jl</title><meta name="title" content="Tools · ComplexMixtures.jl"/><meta property="og:title" content="Tools · ComplexMixtures.jl"/><meta property="twitter:title" content="Tools · ComplexMixtures.jl"/><meta name="description" content="Documentation for ComplexMixtures.jl."/><meta property="og:description" content="Documentation for ComplexMixtures.jl."/><meta property="twitter:description" content="Documentation for ComplexMixtures.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img class="docs-light-only" src="../assets/logo.svg" alt="ComplexMixtures.jl logo"/><img class="docs-dark-only" src="../assets/logo-dark.svg" alt="ComplexMixtures.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">ComplexMixtures.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Introduction</a></li><li><span class="tocitem">Install and run</span><ul><li><a class="tocitem" href="../installation/">Installation</a></li><li><a class="tocitem" href="../parallel/">Parallel execution</a></li><li><a class="tocitem" href="../python/">From Python</a></li></ul></li><li><a class="tocitem" href="../quickguide/">Quick Guide</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../examples/">Running the examples</a></li><li><a class="tocitem" href="../example1/">Protein in water/glycerol</a></li><li><a class="tocitem" href="../example2/">Polyacrylamide in DMF</a></li><li><a class="tocitem" href="../example3/">POPC membrane in water/ethanol</a></li><li><a class="tocitem" href="../example4/">Water/Glycerol mixture</a></li></ul></li><li><span class="tocitem">Setup and run</span><ul><li><a class="tocitem" href="../selection/">Set solute and solvent</a></li><li><a class="tocitem" href="../mddf/">Computing the MDDF</a></li><li><a class="tocitem" href="../save/">Save and load</a></li><li><a class="tocitem" href="../multiple/">Multiple trajectories</a></li><li><a class="tocitem" href="../options/">Options</a></li></ul></li><li><span class="tocitem">Analysis</span><ul><li><a class="tocitem" href="../results/">Results</a></li><li><a class="tocitem" href="../contributions/">Atomic and group contributions</a></li><li><a class="tocitem" href="../density_maps/">Density maps</a></li><li><a class="tocitem" href="../coordination_numbers/">Coordination numbers</a></li><li class="is-active"><a class="tocitem" href>Tools</a><ul class="internal"><li><a class="tocitem" href="#radial_distribution"><span>Computing radial distribution functions</span></a></li><li><a class="tocitem" href="#overview"><span>Overview of the solvent and solute properties</span></a></li></ul></li></ul></li><li><a class="tocitem" href="../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Analysis</a></li><li class="is-active"><a href>Tools</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Tools</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/m3g/ComplexMixtures.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/m3g/ComplexMixtures.jl/blob/main/docs/src/tools.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Tools"><a class="docs-heading-anchor" href="#Tools">Coordination numbers</a><a id="Tools-1"></a><a class="docs-heading-anchor-permalink" href="#Tools" title="Permalink"></a></h1><ul><li><a href="#radial_distribution">Computing radial distribution functions</a></li><li><a href="#overview">Overview of the solvent and solute properties</a></li></ul><h2 id="radial_distribution"><a class="docs-heading-anchor" href="#radial_distribution">Computing radial distribution functions</a><a id="radial_distribution-1"></a><a class="docs-heading-anchor-permalink" href="#radial_distribution" title="Permalink"></a></h2><p>The distributions returned by the <code>mddf</code> function (the <code>mddf</code> and <code>rdf</code> vectors), are normalized by the random reference state. This is equivalent to  a site count based on the numerical integration of the volume corresponding to each minimum-distance to the solute. </p><p>If, however, the solute is defined by a single atom (as the oxygen atom of water, for example), the numerical integration of the volume can be replaced by a simple analytical spherical shell volume, reducing noise. The <code>ComplexMixtures.gr</code> function returns the radial distribution function and the KB integral  computed from the results, using this volume estimate: </p><pre><code class="language-julia hljs">g, kb = ComplexMixtures.gr(R)</code></pre><p>By default, the single-reference count (<code>rdf_count</code>) of the Result structure will be used to compute the radial distribution function. The function can be called with explicit control of all input parameters: </p><pre><code class="language-julia hljs">g, kb = ComplexMixtures.gr(r,count,density,binstep)</code></pre><p>where:</p><table><tr><th style="text-align: center">Parameter</th><th style="text-align: left">Definition</th><th style="text-align: left">Result structure output data to provide</th></tr><tr><td style="text-align: center"><code>r</code></td><td style="text-align: left">Vector of distances</td><td style="text-align: left">The <code>d</code> vector</td></tr><tr><td style="text-align: center"><code>count</code></td><td style="text-align: left">Number of site counts at each r</td><td style="text-align: left">The <code>rdf</code> or <code>mddf</code> vectors</td></tr><tr><td style="text-align: center"><code>density</code></td><td style="text-align: left">Bulk density</td><td style="text-align: left">The <code>density.solvent_bulk</code> or <code>density.solvent</code> densities.</td></tr><tr><td style="text-align: center"><code>binstep</code></td><td style="text-align: left">The histogram step</td><td style="text-align: left">The <code>options.binstep</code></td></tr><tr><td style="text-align: center"></td><td style="text-align: left"></td><td style="text-align: left"></td></tr></table><p>Example:</p><pre><code class="language-julia hljs">...
R = mddf(trajectory_file, solute, solvent, options)
g, kb = ComplexMixtures.gr(R.d,R.rdf_count,R.density.solvent_bulk,R.options.binstep)</code></pre><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ComplexMixtures.gr-Tuple{AbstractVector{&lt;:Real}, AbstractVector{&lt;:Real}, Real, Real}" href="#ComplexMixtures.gr-Tuple{AbstractVector{&lt;:Real}, AbstractVector{&lt;:Real}, Real, Real}"><code>ComplexMixtures.gr</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">gr(r::AbstractVector{&lt;:Real}, count::AbstractVector{&lt;:Real}, density::Real, binstep::Real)</code></pre><p>Computes the radial distribution function from the count data and the density.</p><p>This is exactly a conventional g(r) if a single atom was chosen as the solute and solvent selections.</p><p>Returns both the g(r) and the kb(r)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/m3g/ComplexMixtures.jl/blob/520b7f19855564edb9098924e29f64fbaa745486/src/tools/gr.jl#L1-L10">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ComplexMixtures.gr-Tuple{Result}" href="#ComplexMixtures.gr-Tuple{Result}"><code>ComplexMixtures.gr</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">gr(R::Result) = gr(R.d,R.rdf_count,R.density.solvent_bulk,R.files[1].options.binstep)</code></pre><p>If a Result structure is provided without further details, use the rdf count and the bulk solvent density.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/m3g/ComplexMixtures.jl/blob/520b7f19855564edb9098924e29f64fbaa745486/src/tools/gr.jl#L28-L33">source</a></section></article><h2 id="overview"><a class="docs-heading-anchor" href="#overview">Overview of the solvent and solute properties</a><a id="overview-1"></a><a class="docs-heading-anchor-permalink" href="#overview" title="Permalink"></a></h2><p>The output to the REPL of the Result structure provides an overview of the properties of the solution. The data can be retrieved into a data structure using the <code>overview</code> function. Examples:     </p><pre><code class="language-julia-repl hljs">...

julia&gt; results = mddf(trajectory_file, solute, solvent, Options(bulk_range=(8.0, 12.0)))

julia&gt; results
--------------------------------------------------------------------------------
MDDF Overview - ComplexMixtures - Version 2.0.8
--------------------------------------------------------------------------------

Solvent properties:
-------------------

Simulation concentration: 0.49837225882780106 mol L⁻¹
Molar volume: 2006.532230249041 cm³ mol⁻¹

Concentration in bulk: 0.5182380507741433 mol L⁻¹
Molar volume in bulk: 1929.6151614228274 cm³ mol⁻¹

Solute properties:
------------------

Simulation Concentration: 0.002753437894076249 mol L⁻¹
Estimated solute partial molar volume: 13921.98945754469 cm³ mol⁻¹

Bulk range: 8.0 - 12.0 Å
Molar volume of the solute domain: 34753.1382279134 cm³ mol⁻¹

Auto-correlation: false

Trajectory files and weights:

   /home/user/NAMD/trajectory.dcd - w = 1.0

Long range MDDF mean (expected 1.0): 1.0378896753018338 ± 1.0920172247127446
Long range RDF mean (expected 1.0): 1.2147429551790854 ± 1.2081838161780682

--------------------------------------------------------------------------------</code></pre><p>In this case, since solute and solvent are equivalent and the system is homogeneous, the molar volumes and concentrations are similar. This is not the case if the molecules are different or if the solute is at infinite dilution (in which case the bulk solvent density might be different from the solvent density in the simulation). </p><p>To retrieve the data of the overview structure use, for example:</p><pre><code class="language-julia-repl hljs">julia&gt; overview = overview(results);

julia&gt; overview.solute_molar_volume
657.5051512801567</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../coordination_numbers/">« Coordination numbers</a><a class="docs-footer-nextpage" href="../references/">References »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.12.0 on <span class="colophon-date" title="Friday 13 June 2025 19:12">Friday 13 June 2025</span>. Using Julia version 1.10.9.</p></section><footer class="modal-card-foot"></footer></div></div></div></body><div data-docstringscollapsed="true"></div></html>
