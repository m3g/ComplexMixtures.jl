<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Tools · ComplexMixtures.jl</title><meta name="title" content="Tools · ComplexMixtures.jl"/><meta property="og:title" content="Tools · ComplexMixtures.jl"/><meta property="twitter:title" content="Tools · ComplexMixtures.jl"/><meta name="description" content="Documentation for ComplexMixtures.jl."/><meta property="og:description" content="Documentation for ComplexMixtures.jl."/><meta property="twitter:description" content="Documentation for ComplexMixtures.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img class="docs-light-only" src="../assets/logo.svg" alt="ComplexMixtures.jl logo"/><img class="docs-dark-only" src="../assets/logo-dark.svg" alt="ComplexMixtures.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">ComplexMixtures.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Introduction</a></li><li><a class="tocitem" href="../installation/">Installation</a></li><li><a class="tocitem" href="../parallel/">Parallel execution</a></li><li><a class="tocitem" href="../quickguide/">Quick Guide</a></li><li><a class="tocitem" href="../examples/">Examples:</a></li><li><a class="tocitem" href="../example1/">◦ Protein in water/glycerol</a></li><li><a class="tocitem" href="../example2/">◦ Polyacrylamide in DMF</a></li><li><a class="tocitem" href="../example3/">◦ POPC membrane in water/ethanol</a></li><li><a class="tocitem" href="../example4/">◦ Water/Glycerol mixture</a></li><li><a class="tocitem" href="../selection/">Set solute and solvent</a></li><li><a class="tocitem" href="../trajectory/">Loading the trajectory</a></li><li><a class="tocitem" href="../mddf/">Computing the MDDF</a></li><li><a class="tocitem" href="../results/">Results</a></li><li><a class="tocitem" href="../contrib/">Atomic and group contributions</a></li><li><a class="tocitem" href="../save/">Save and load</a></li><li><a class="tocitem" href="../multiple/">Multiple trajectories</a></li><li><a class="tocitem" href="../options/">Options</a></li><li class="is-active"><a class="tocitem" href>Tools</a><ul class="internal"><li><a class="tocitem" href="#coordination_number"><span>Coordination numbers</span></a></li><li><a class="tocitem" href="#Computing-a-2D-density-map-around-a-macromolecule"><span>Computing a 2D density map around a macromolecule</span></a></li><li><a class="tocitem" href="#Computing-a-3D-density-map-around-a-macromolecule"><span>Computing a 3D density map around a macromolecule</span></a></li><li><a class="tocitem" href="#Computing-radial-distribution-functions"><span>Computing radial distribution functions</span></a></li><li><a class="tocitem" href="#Overview-of-the-solvent-and-solute-properties"><span>Overview of the solvent and solute properties</span></a></li></ul></li><li><a class="tocitem" href="../python/">From Python</a></li><li><a class="tocitem" href="../updating_scripts/">Updating scripts</a></li><li><a class="tocitem" href="../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Tools</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Tools</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/m3g/ComplexMixtures.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/m3g/ComplexMixtures.jl/blob/main/docs/src/tools.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Tools"><a class="docs-heading-anchor" href="#Tools">Tools</a><a id="Tools-1"></a><a class="docs-heading-anchor-permalink" href="#Tools" title="Permalink"></a></h1><p>A set of examples of analyses that can be performed with <code>ComplexMixtures</code> is given  in <a href="https://github.com/m3g/ComplexMixturesExamples">this site</a>. A brief the description of the possible results is provided here.   </p><p>Some tools are provided to analyze the results:</p><h2 id="coordination_number"><a class="docs-heading-anchor" href="#coordination_number">Coordination numbers</a><a id="coordination_number-1"></a><a class="docs-heading-anchor-permalink" href="#coordination_number" title="Permalink"></a></h2><p>The function</p><pre><code class="language-julia hljs">coordination_number(R::Result, group::Union{SoluteGroup, SolventGroup})</code></pre><p>computes the coordination number of a given group of atoms from the solute or solvent atomic contributions to the MDDF. Here, <code>R</code> is the result of the <code>mddf</code> calculation, and <code>group_contributions</code> is the output of the <code>contributions</code> function for the desired set of atoms.</p><p>If no group is defined, the coordination number of the complete solute is returned, which is equivalent to the <code>R.coordination_number</code> field of the <code>Result</code> data structure:</p><pre><code class="nohighlight hljs">coordination_number(R::Result) == R.coordination_number</code></pre><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>There are some systems for which the normalization of the distributions is not  necessary or possible. It is still possible to compute the coordination numbers, by running, instead of <code>mddf</code>, the <code>coordination_number</code> function:</p><pre><code class="nohighlight hljs">coordination_number(trajectory::Trajectory, options::Options)</code></pre><p>This call will return <code>Result</code> data structure but with all fields requiring  normalization with zeros. In summary, this result data structure can be used to compute the coordination numbers, but not the MDDF, RDF, or KB integrals.</p></div></div><div class="admonition is-compat"><header class="admonition-header">Compat</header><div class="admonition-body"><p>The use independent computation of coordination numbers was introduced in version 1.1.</p></div></div><h3 id="Example"><a class="docs-heading-anchor" href="#Example">Example</a><a id="Example-1"></a><a class="docs-heading-anchor-permalink" href="#Example" title="Permalink"></a></h3><p>In the following example we compute the coordination number of the atoms of <code>residue 50</code> (which belongs to the solute - a protein) with the solvent atoms of TMAO, as a function of the distance. The plot produced will show side by side the residue contribution to the MDDF and the corresponding coordination number.</p><pre><code class="language-julia hljs">using ComplexMixtures, PDBTools
using Plots, EasyFit
pdb = readPDB(&quot;test/data/NAMD/structure.pdb&quot;)
R = load(&quot;test/data/NAMD/protein_tmao.json&quot;)
solute = AtomSelection(PDBTools.select(pdb, &quot;protein&quot;), nmols=1)
residue50 = PDBTools.select(pdb, &quot;residue 50&quot;)
# Compute the group contribution to the MDDF
residue50_contribution = contributions(R, SoluteGroup(residue50))
# Now compute the coordination number
residue50_coordination = coordination_number(R, SoluteGroup(residue50))
# Plot with twin y-axis
plot(R.d, movavg(residue50_contribution,n=10).x,
    xaxis=&quot;distance / Å&quot;, 
    yaxis=&quot;MDDF contribution&quot;, 
    linewidth=2, label=nothing, color=1
)
plot!(twinx(),R.d, residue50_coordination, 
    yaxis=&quot;Coordination number&quot;, 
    linewidth=2, label=nothing, color=2
)
plot!(title=&quot;Residue 50&quot;, framestyle=:box, subplot=1)</code></pre><p>With appropriate input data, this code produces:</p><center>
<img width=60% src="../figures/coordination.png" width=80%>
</center><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ComplexMixtures.coordination_number" href="#ComplexMixtures.coordination_number"><code>ComplexMixtures.coordination_number</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">coordination_number(R::Result) = R.coordination_number
coordination_number(R::Result, s::Union{SoluteGroup,SolventGroup})</code></pre><p>Computes the coordination number of a given group of atoms of the solute or solvent</p><p>atomic contributions to the MDDF.  If no group is defined (first call above), the coordination number of the whole solute or solvent is returned.</p><p>If the <code>group_contributions</code> to the <code>mddf</code> are computed previously with the <code>contributions</code> function, the result can be used to compute the coordination number by calling <code>coordination_number(R::Result, group_contributions)</code>.</p><p>Otherwise, the coordination number can be computed directly with the second call, where:</p><p><code>s</code> is the solute or solvent selection (type <code>ComplexMixtures.AtomSelection</code>)</p><p><code>atom_contributions</code> is the <code>R.solute_atom</code> or <code>R.solvent_atom</code> arrays of the <code>Result</code> structure</p><p><code>R</code> is the <code>Result</code> structure,</p><p>and the last argument is the selection of atoms from the solute to be considered, given as a list of indices, list of atom names,  or a selection following the syntax of <code>PDBTools</code>, or vector of <code>PDBTools.Atom</code>s, or a <code>PDBTools.Residue</code></p><p><strong>Examples</strong></p><p>In the following example we compute the coordination number of the atoms of residue 50 (of the solute) with the solvent atoms of TMAO, as a function of the distance. Finally, we show the average number of TMAO molecules within 5 Angstroms of residue 50.  The <code>findlast(&lt;(5), R.d)</code> part of the code below returns the index of the last element of the <code>R.d</code> array that is smaller than 5 Angstroms.</p><p><strong>Precomputing the group contributions Using the <code>contributions</code> function</strong></p><pre><code class="language-julia hljs">using ComplexMixtures, PDBTools
pdb = readPDB(&quot;test/data/NAMD/structure.pdb&quot;);
R = load(&quot;test/data/NAMD/protein_tmao.json&quot;);
solute = AtomSelection(PDBTools.select(pdb, &quot;protein&quot;), nmols=1);
residue50 = PDBTools.select(pdb, &quot;residue 50&quot;);
# Compute the group contributions to the MDDF
residue50_contribution = contributions(solute, R.solute_atom, residue50);
# Now compute the coordination number
residue50_coordination = coordination_number(R, residue50_contribution)
# Output the average number of TMAO molecules within 5 Angstroms of residue 50
residue50_coordination[findlast(&lt;(5), R.d)]</code></pre><p><strong>Without precomputing the <code>group_contribution</code></strong></p><pre><code class="language-julia hljs">using ComplexMixtures, PDBTools
pdb = readPDB(&quot;test/data/NAMD/structure.pdb&quot;);
R = load(&quot;test/data/NAMD/protein_tmao.json&quot;);
solute = AtomSelection(PDBTools.select(pdb, &quot;protein&quot;), nmols=1);
residue50 = PDBTools.select(pdb, &quot;residue 50&quot;);
# Compute the coordination number
residue50_coordination = coordination_number(solute, R.solute_atom, R, group)
# Output the average number of TMAO molecules within 5 Angstroms of residue 50
residue50_coordination[findlast(&lt;(5), R.d)]</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/m3g/ComplexMixtures.jl/blob/de1f5406150168d0f03b7d74d4e4096750937aab/src/tools/coordination_number.jl#L1-L60">source</a></section></article><h2 id="Computing-a-2D-density-map-around-a-macromolecule"><a class="docs-heading-anchor" href="#Computing-a-2D-density-map-around-a-macromolecule">Computing a 2D density map around a macromolecule</a><a id="Computing-a-2D-density-map-around-a-macromolecule-1"></a><a class="docs-heading-anchor-permalink" href="#Computing-a-2D-density-map-around-a-macromolecule" title="Permalink"></a></h2><p>One nice way to visualize the accumulation or depletion of a solvent around a macromolecule (a protein, for example), is to obtain a 2D map of the density as a function of the distance from its surface. For example, in the figure below the density of a solute (here, Glycerol), in the neighborhood of a protein is shown:</p><center>
<img src="../figures/density.png" width=80%>
</center><p>Here, one can see that Glycerol accumulates on Asp76 and on the proximity of hydrogen-bonding residues (Serine residues mostly). This figure was obtained by extracting from atomic contributions of the protein the contribution of each residue to the MDDF. Using <code>PDBTools</code>, this can be done with, for example: </p><pre><code class="language-julia hljs">residues = collect(eachresidue(protein))
residue_contributions = zeros(length(R.d),length(residues))
for (i,residue) in pairs(residues)
  c = contributions(results, SoluteGroup(residue)) 
  residue_contributions[:,i] .= c
end</code></pre><p>The above produces a matrix with a number of columns equal to the number of residues and a number of rows equal to the number of MDDF points. That matrix can be plotted as a contour map with adequate plotting software. <a href="../example1/#2D-map-example1">A complete running example is provided here</a>, producing the figure above.    </p><h2 id="Computing-a-3D-density-map-around-a-macromolecule"><a class="docs-heading-anchor" href="#Computing-a-3D-density-map-around-a-macromolecule">Computing a 3D density map around a macromolecule</a><a id="Computing-a-3D-density-map-around-a-macromolecule-1"></a><a class="docs-heading-anchor-permalink" href="#Computing-a-3D-density-map-around-a-macromolecule" title="Permalink"></a></h2><p>Three-dimensional representations of the distribution functions can also be obtained from the MDDF results. These 3D representations are obtained from the fact that the MDDFs can be decomposed into the contributions of each solute atom, and that each point in space is closest to a single solute atom as well. Thus, each point in space can be associated to one solute atom, and the contribution of that atom to the MDDF at the corresponding distance can be obtained.   </p><p>For example, the distribution function of a hydrogen-bonding liquid solvating a protein will display a characteristic peak at about 1.8Å. The MDDF at that distance can be decomposed into the contributions of all atoms of the protein which were found to form hydrogen bonds to the solvent. A 3D representation of these contributions can be obtained by computing, around a static protein (solute) structure, which are the regions in space which are closer to each atom of the protein. The position in space is then marked with the atom of the protein to which that region &quot;belongs&quot; and with the contribution of that atom to the MDDF at each distance within that region. A special function to compute this 3D distribution is provided here: <code>grid3D</code>. </p><p>This is better illustrated by a graphical representation. In the figure below we see a 3D representation of the MDDF of Glycerol around a protein, computed from a simulation of this protein in a mixture of water and Glycerol. A complete set of files and a script to reproduce this example <a href="../example1/#3D-map-example1">is available here</a>. </p><center>
<img src="../figures/density3D_final.png" width=100%>
</center><p>In the figure on the left, the points in space around the protein are selected with the following properties: distance from the protein smaller than 2.0Å and relative contribution to the MDDF at the corresponding distance of at least 10% of the maximum contribution. Thus, we are selecting the regions of the protein corresponding to the most stable hydrogen-bonding interactions. The color of the points is the contribution to the MDDF, from blue to red. Thus, the most reddish-points corresponds to the regions where the most stable hydrogen bonds were formed. We have marked two regions here, on opposite sides of the protein, with arrows.</p><p>Clicking on those points we obtain which are the atoms of the protein contributing to the MDDF at that region. In particular, the arrow on the right points to the strongest red region, which corresponds to an Aspartic acid. These residues are shown explicitly under the density (represented as a transparent surface) on the figure in the center.   </p><p>The figure on the right displays, overlapped with the hydrogen-bonding residues, the most important contributions to the second peak of the distribution, corresponding to distances from the protein between 2.0 and 3.5Å. Notably, the regions involved are different from the ones forming hydrogen bonds, indicating that non-specific interactions with the protein (and not a second solvation shell) are responsible for the second peak. </p><p>The call to <code>grid3D</code> in the last command will write an output a PDB file with the grid points, which loaded in a visualization software side-by-side with the protein structure, allows the production of the images shown. The <code>grid.pdb</code> file contains a regular PDB format, but the atoms are grid points. The identity of the atoms correspond to the identity of the protein atom contributing to the MDDF at that point (the closest protein atom). The temperature-factor column (<code>beta</code>) contains the relative contribution of that atom to the MDDF at the corresponding distance, and the <code>occupancy</code> field contains the distance itself.</p><p>The output <code>grid</code> variable contains the same information of the PDB file, which can be analyzed with the tools of <code>PDBTools</code> if the user wants to.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ComplexMixtures.grid3D" href="#ComplexMixtures.grid3D"><code>ComplexMixtures.grid3D</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">grid3D(
    result::Result, atoms, output_file::Union{Nothing,String} = nothing; 
    dmin=1.5, ddax=5.0, step=0.5, silent = false,
)</code></pre><p>This function builds the grid of the 3D density function and fills an array of mutable structures of type Atom, containing the position of the atoms of  grid, the closest atom to that position, and distance. </p><p><code>result</code> is a <code>ComplexMixtures.Result</code> object  <code>atoms</code> is a vector of <code>PDBTools.Atom</code>s with all the atoms of the system.  <code>output_file</code> is the name of the file where the grid will be written. If <code>nothing</code>, the grid is only returned as a matrix. </p><p><code>dmin</code> and <code>dmax</code> define the range of distance where the density grid will be built, and <code>step</code> defines how fine the grid must be. Be aware that fine grids involve usually a very large (hundreds of thousands points).</p><p><code>silent</code> is a boolean to suppress the progress bar.</p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; using ComplexMixtures, PDBTools

julia&gt; atoms = readPDB(&quot;./system.pdb&quot;);

julia&gt; R = ComplexMixtures.load(&quot;./results.json&quot;);

julia&gt; grid = grid3D(R, atoms, &quot;grid.pdb&quot;);</code></pre><p><code>grid</code> will contain a vector of <code>Atom</code>s with the information of the MDDF at each grid point, and the same data will be written in the <code>grid.pdb</code> file. This PDB file can be opened in VMD, for example, and contain in the <code>beta</code> field the contribution of each protein residue to the MDDF at each point in space relative to the  protein, and in the <code>occupancy</code> field the distance to the protein. Examples of how this information can be visualized are provided in the user guide of <code>ComplexMixtures</code>. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/m3g/ComplexMixtures.jl/blob/de1f5406150168d0f03b7d74d4e4096750937aab/src/tools/grid3D.jl#L1-L39">source</a></section></article><h2 id="Computing-radial-distribution-functions"><a class="docs-heading-anchor" href="#Computing-radial-distribution-functions">Computing radial distribution functions</a><a id="Computing-radial-distribution-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Computing-radial-distribution-functions" title="Permalink"></a></h2><p>The distributions returned by the <code>mddf</code> function (the <code>mddf</code> and <code>rdf</code> vectors), are normalized by the random reference state or using a site count based on the numerical integration of the volume corresponding to each minimum-distance to the solute. </p><p>If, however, the solute is defined by a single atom (as the oxygen atom of water, for example), the numerical integration of the volume can be replaced by a simple analytical spherical shell volume, reducing noise. The <code>ComplexMixtures.gr</code> function returns the radial distribution function and the KB integral  computed from the results, using this volume estimate: </p><pre><code class="language-julia hljs">g, kb = ComplexMixtures.gr(R)</code></pre><p>By default, the single-reference count (<code>rdf_count</code>) of the Result structure will be used to compute the radial distribution function. The function can be called with explicit control of all input parameters: </p><pre><code class="language-julia hljs">g, kb = ComplexMixtures.gr(r,count,density,binstep)</code></pre><p>where:</p><table><tr><th style="text-align: center">Parameter</th><th style="text-align: left">Definition</th><th style="text-align: left">Result structure output data to provide</th></tr><tr><td style="text-align: center"><code>r</code></td><td style="text-align: left">Vector of distances</td><td style="text-align: left">The <code>d</code> vector</td></tr><tr><td style="text-align: center"><code>count</code></td><td style="text-align: left">Number of site counts at each r</td><td style="text-align: left">The <code>rdf</code> or <code>mddf</code> vectors</td></tr><tr><td style="text-align: center"><code>density</code></td><td style="text-align: left">Bulk density</td><td style="text-align: left">The <code>density.solvent_bulk</code> or <code>density.solvent</code> densities.</td></tr><tr><td style="text-align: center"><code>binstep</code></td><td style="text-align: left">The histogram step</td><td style="text-align: left">The <code>options.binstep</code></td></tr><tr><td style="text-align: center"></td><td style="text-align: left"></td><td style="text-align: left"></td></tr></table><p>Example:</p><pre><code class="language-julia hljs">...
R = mddf(trajectory, options)
g, kb = ComplexMixtures.gr(R.d,R.rdf_count,R.density.solvent_bulk,R.options.binstep)</code></pre><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ComplexMixtures.gr-Tuple{Result}" href="#ComplexMixtures.gr-Tuple{Result}"><code>ComplexMixtures.gr</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">gr(R::Result) = gr(R.d,R.rdf_count,R.density.solvent_bulk,R.files[1].options.binstep)</code></pre><p>If a Result structure is provided without further details, use the rdf count and the bulk solvent density.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/m3g/ComplexMixtures.jl/blob/de1f5406150168d0f03b7d74d4e4096750937aab/src/tools/gr.jl#L28-L33">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ComplexMixtures.gr-Tuple{Vector{Float64}, Vector{Float64}, Float64, Float64}" href="#ComplexMixtures.gr-Tuple{Vector{Float64}, Vector{Float64}, Float64, Float64}"><code>ComplexMixtures.gr</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">gr(r::Vector{Float64}, count::Vector{Float64}, density::Float64, binstep::Float64)</code></pre><p>Computes the radial distribution function from the count data and the density.</p><p>This is exactly a conventional g(r) if a single atom was chosen as the solute and solvent selections.</p><p>Returns both the g(r) and the kb(r)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/m3g/ComplexMixtures.jl/blob/de1f5406150168d0f03b7d74d4e4096750937aab/src/tools/gr.jl#L1-L10">source</a></section></article><h2 id="Overview-of-the-solvent-and-solute-properties"><a class="docs-heading-anchor" href="#Overview-of-the-solvent-and-solute-properties">Overview of the solvent and solute properties</a><a id="Overview-of-the-solvent-and-solute-properties-1"></a><a class="docs-heading-anchor-permalink" href="#Overview-of-the-solvent-and-solute-properties" title="Permalink"></a></h2><p>The output to the REPL of the Result structure provides an overview of the properties of the solution. The data can be retrieved into a data structure using the <code>overview</code> function. Examples:     </p><pre><code class="language-julia-repl hljs">...

julia&gt; results = mddf(trajectory, Options(bulk_range=(8.0, 12.0)))

julia&gt; results
--------------------------------------------------------------------------------
MDDF Overview - ComplexMixtures - Version 2.0.8
--------------------------------------------------------------------------------

Solvent properties:
-------------------

Simulation concentration: 0.49837225882780106 mol L⁻¹
Molar volume: 2006.532230249041 cm³ mol⁻¹

Concentration in bulk: 0.5182380507741433 mol L⁻¹
Molar volume in bulk: 1929.6151614228274 cm³ mol⁻¹

Solute properties:
------------------

Simulation Concentration: 0.002753437894076249 mol L⁻¹
Estimated solute partial molar volume: 13921.98945754469 cm³ mol⁻¹

Bulk range: 8.0 - 12.0 Å
Molar volume of the solute domain: 34753.1382279134 cm³ mol⁻¹

Auto-correlation: false

Trajectory files and weights:

   /home/user/NAMD/trajectory.dcd - w = 1.0

Long range MDDF mean (expected 1.0): 1.0378896753018338 ± 1.0920172247127446
Long range RDF mean (expected 1.0): 1.2147429551790854 ± 1.2081838161780682

--------------------------------------------------------------------------------</code></pre><p>In this case, since solute and solvent are equivalent and the system is homogeneous, the molar volumes and concentrations are similar. This is not the case if the molecules are different or if the solute is at infinite dilution (in which case the bulk solvent density might be different from the solvent density in the simulation). </p><p>To retrieve the data of the overview structure use, for example:</p><pre><code class="language-julia-repl hljs">julia&gt; overview = overview(results);

julia&gt; overview.solute_molar_volume
657.5051512801567</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../options/">« Options</a><a class="docs-footer-nextpage" href="../python/">From Python »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.3.0 on <span class="colophon-date" title="Thursday 14 March 2024 16:50">Thursday 14 March 2024</span>. Using Julia version 1.10.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
