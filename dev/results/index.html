<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Results · ComplexMixtures.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="ComplexMixtures.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">ComplexMixtures.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Introduction</a></li><li><a class="tocitem" href="../installation/">Installation</a></li><li><a class="tocitem" href="../quickguide/">Quick Guide</a></li><li><a class="tocitem" href="../examples/">Full Example</a></li><li><a class="tocitem" href="../selection/">Set solute and solvent</a></li><li><a class="tocitem" href="../trajectory/">Loading the trajectory</a></li><li><a class="tocitem" href="../mddf/">Computing the MDDF</a></li><li class="is-active"><a class="tocitem" href>Results</a><ul class="internal"><li><a class="tocitem" href="#The-Result-data-structure:-main-data"><span>The Result data structure: main data</span></a></li><li><a class="tocitem" href="#Distances-of-the-histograms:-results.d"><span>Distances of the histograms: <code>results.d</code></span></a></li><li><a class="tocitem" href="#Minimum-distance-distribution-function:-results.mddf"><span>Minimum-distance distribution function: <code>results.mddf</code></span></a></li><li><a class="tocitem" href="#Kirkwood-Buff-integral:-results.kb"><span>Kirkwood-Buff integral: <code>results.kb</code></span></a></li><li><a class="tocitem" href="#Units"><span>Units</span></a></li><li><a class="tocitem" href="#Coordination-number-and-other-data"><span>Coordination number and other data</span></a></li></ul></li><li><a class="tocitem" href="../contrib/">Atomic and group contributions</a></li><li><a class="tocitem" href="../save/">Save and load</a></li><li><a class="tocitem" href="../multiple/">Multiple trajectories</a></li><li><a class="tocitem" href="../parallel/">Parallel execution</a></li><li><a class="tocitem" href="../options/">Options</a></li><li><a class="tocitem" href="../tools/">Tools</a></li><li><a class="tocitem" href="../help/">Help entries</a></li><li><a class="tocitem" href="../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Results</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Results</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/m3g/ComplexMixtures.jl/blob/master/docs/src/results.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="results"><a class="docs-heading-anchor" href="#results">Results</a><a id="results-1"></a><a class="docs-heading-anchor-permalink" href="#results" title="Permalink"></a></h1><p>The results of a MDDF calculation are returned in a data structure which contains  the MDDF, KB integrals, and atomic contributions. The following section will assume that the computation was performed by calling the <code>mddf</code> function with </p><pre><code class="language-julia hljs">results = mddf(trajectory)</code></pre><p>such that the <code>results</code> variable contain the <code>Result</code> data structure. By default, the histograms contain 500 bins (<code>binstep=0.002</code> and <code>cutoff=10.</code>) such that all data-vectors will contain 500 lines.</p><p>To know how to save and load saved data, read the <a href="../save/#save">next</a> section.</p><h2 id="The-Result-data-structure:-main-data"><a class="docs-heading-anchor" href="#The-Result-data-structure:-main-data">The Result data structure: main data</a><a id="The-Result-data-structure:-main-data-1"></a><a class="docs-heading-anchor-permalink" href="#The-Result-data-structure:-main-data" title="Permalink"></a></h2><p>The most important data to be read from <code>results</code> are the distances, minimum-distance distribution function, and KB integrals. These data is stored in the following vectors:</p><h2 id="Distances-of-the-histograms:-results.d"><a class="docs-heading-anchor" href="#Distances-of-the-histograms:-results.d">Distances of the histograms: <code>results.d</code></a><a id="Distances-of-the-histograms:-results.d-1"></a><a class="docs-heading-anchor-permalink" href="#Distances-of-the-histograms:-results.d" title="Permalink"></a></h2><p>The following vector will contain values ranging from 0. to <code>cutoff</code>, and the distance at each bin is the distance in that bin for which half of the volume of the bin is within <code>d</code>, and half of the volume is above <code>d</code>, if the volume was spherical: </p><pre><code class="language-julia hljs">julia&gt; results.d
500-element Array{Float64,1}:
 0.015874010519682
 0.033019272488946275
 ⋮
 9.970010030080179
 9.99001000999998
</code></pre><h2 id="Minimum-distance-distribution-function:-results.mddf"><a class="docs-heading-anchor" href="#Minimum-distance-distribution-function:-results.mddf">Minimum-distance distribution function: <code>results.mddf</code></a><a id="Minimum-distance-distribution-function:-results.mddf-1"></a><a class="docs-heading-anchor-permalink" href="#Minimum-distance-distribution-function:-results.mddf" title="Permalink"></a></h2><p>The <code>results.mddf</code> vector will contain the main result, which the minimum-distance distribution function. For a properly-sampled simulation, it will be zero at very short distances and converge to 1.0 for distances smaller than the <code>cutoff</code>:</p><pre><code class="language-julia hljs">julia&gt; results.mddf
500-element Array{Float64,1}:
 0.0
 0.0
     ⋮
 0.999052514965403
 1.001030818286187
</code></pre><p>A typical plot of <code>results.mddf</code> as a function of <code>results.d</code> will look like:</p><img src="../figures/mddf.png" width="60%"><p>Thus, this plot was obtained with the following code:</p><pre><code class="language-julia hljs">using Plots
plot(results.d,results.mddf,xlabel=&quot;d/A&quot;,ylabel=&quot;mddf(d) / L/mol&quot;) </code></pre><h2 id="Kirkwood-Buff-integral:-results.kb"><a class="docs-heading-anchor" href="#Kirkwood-Buff-integral:-results.kb">Kirkwood-Buff integral: <code>results.kb</code></a><a id="Kirkwood-Buff-integral:-results.kb-1"></a><a class="docs-heading-anchor-permalink" href="#Kirkwood-Buff-integral:-results.kb" title="Permalink"></a></h2><p>The <code>results.kb</code> vector will contain the Kirkwood-Buff integral computed as a function of the minimum-distance to the solute. For properly sampled simulations, it is expected to converge at large distances.  </p><pre><code class="language-julia hljs">julia&gt; results.kb
500-element Array{Float64,1}:
     0.0
    -0.3249356504752985
    -2.9804719721525
     ⋮
    0.72186381783
    1.13624162115
</code></pre><p>A typical plot of <code>results.kb</code> as a function of <code>results.d</code> will look like:</p><img src="../figures/kb.png" width="60%"><p>Thus, this plot was obtained with the following code:</p><pre><code class="language-julia hljs">using Plots
plot(results.d,results.kb,xlabel=&quot;d/A&quot;,ylabel=&quot;mddf(d) / L/mol&quot;) </code></pre><h2 id="Units"><a class="docs-heading-anchor" href="#Units">Units</a><a id="Units-1"></a><a class="docs-heading-anchor-permalink" href="#Units" title="Permalink"></a></h2><ul><li><p>The distance is assumed to be in Å, as this is the most common distance units in molecular simulations. The coordinates of the atoms are assumed be provided in Å. </p></li><li><p>The minimum-distance distribution function is unit-less, since it is the ratio of the density at each distance divided by an ideal-gas density.</p></li><li><p>The Kirkwood-Buff integrals are returned in cm³ mol⁻¹, if the coordinates were provided in Å.</p></li></ul><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>If the coordinates are not in Å, the calculation will  proceed normally, but the units of the KB integrals, which has units of volume per mol, should be converted to conform the length unit provided. </p></div></div><h2 id="Coordination-number-and-other-data"><a class="docs-heading-anchor" href="#Coordination-number-and-other-data">Coordination number and other data</a><a id="Coordination-number-and-other-data-1"></a><a class="docs-heading-anchor-permalink" href="#Coordination-number-and-other-data" title="Permalink"></a></h2><p>Obtaining the MDDF involves the computation of some intermediate properties that are frequently useful for additional solution structure analysis. In particular, the coordination numbers are computed. For example, the coordination number as a function from the distance to the solute can be retrieved from a <code>Results</code> data structure with:</p><pre><code class="language-julia hljs">coordination_number = result.sum_md_count</code></pre><p>and this data can be plotted against the distances by:</p><pre><code class="language-julia hljs">plot(result.d,result.sum_md_count)</code></pre><p>The complete data available is:</p><table><tr><th style="text-align: right">Parameter</th><th style="text-align: right">Meaning</th><th style="text-align: right">Type of value</th><th style="text-align: right">Comment</th></tr><tr><td style="text-align: right"><code>d</code></td><td style="text-align: right">Vector of distances of the histograms.</td><td style="text-align: right"><code>Vector{Float64}</code></td><td style="text-align: right">To be used as the <code>x</code> coordinate on plotting any of the data.</td></tr><tr><td style="text-align: right"><code>md_count</code></td><td style="text-align: right">Non-normalized count of minimum distances at each <code>d</code>.</td><td style="text-align: right"><code>Vector{Float64}</code></td><td style="text-align: right">This is the number of minimum distances found at each histogram bin, without normalization. Usually this is not interesting to analyze, because it is dependent on the bin size.</td></tr><tr><td style="text-align: right"><code>md_count_random</code></td><td style="text-align: right">Number of minimum distances found at each histogram bin for the random distribution.</td><td style="text-align: right"><code>Vector{Float64}</code></td><td style="text-align: right">This is the normalization required to convert the <code>md_count</code> array into the minimum-distance distribution.</td></tr><tr><td style="text-align: right"><code>sum_md_count</code></td><td style="text-align: right">Cumulative number of sites found for each histogram distance.</td><td style="text-align: right"><code>Vector{Float64}</code></td><td style="text-align: right"><strong>This is the coordination number</strong>, that is, the number of sites found cumulative up to each distance, without any normalization.</td></tr><tr><td style="text-align: right"><code>sum_md_count_random</code></td><td style="text-align: right">Cumulative site count for the random distribution.</td><td style="text-align: right"><code>Vector{Float64}</code></td><td style="text-align: right">Usually not interesting for analysis.</td></tr><tr><td style="text-align: right"><code>mddf</code></td><td style="text-align: right">The final distribution function.</td><td style="text-align: right"><code>Vector{Float64}</code></td><td style="text-align: right">This is the MDDF computed (<code>md_count</code> normalized by <code>md_count_random</code>). It is the main result of the calculation.</td></tr><tr><td style="text-align: right"><code>kb</code></td><td style="text-align: right">The final Kirkwood-Buff integral.</td><td style="text-align: right"><code>Vector{Float64}</code></td><td style="text-align: right">This is the final KB integral, as a function of the integration distance from the solute. Computed as <code>sum_md_count - sum_md_count_random</code></td></tr><tr><td style="text-align: right"><code>solute_atom</code></td><td style="text-align: right">Atomic contributions of the solute.</td><td style="text-align: right"><code>Matrix{Float64}</code></td><td style="text-align: right">This is a matrix with <code>nbins</code> lines and <code>solute.natomspermol</code> columns, containing the atomic contributions of each solute atom to the complete MDDF.</td></tr><tr><td style="text-align: right"><code>solvent_atom</code></td><td style="text-align: right">Atomic contributions of the solvent.</td><td style="text-align: right"><code>Matrix{Float64}</code></td><td style="text-align: right">This is a matrix with <code>nbins</code> lines and <code>solvent.natomspermol</code> columns, containing the atomic contributions of each solvent atom to the complete MDDF.</td></tr><tr><td style="text-align: right"><code>density</code></td><td style="text-align: right">Density properties of the system.</td><td style="text-align: right"><code>Density</code></td><td style="text-align: right">Contains the data of the solute density, solvent density, and solvent density at the bulk region.</td></tr><tr><td style="text-align: right"><code>volume</code></td><td style="text-align: right">Volume measures.</td><td style="text-align: right"><code>Volume</code></td><td style="text-align: right">Contains the total volume of the simulation, the bulk volume, the volume of the solute domain and the shell volume of each <code>bin</code> of the histogram. These are computed by numerical integration from the random distributions.</td></tr><tr><td style="text-align: right"><code>files</code></td><td style="text-align: right">List of files read.</td><td style="text-align: right"><code>Vector{String}</code></td><td style="text-align: right"></td></tr><tr><td style="text-align: right"><code>weights</code></td><td style="text-align: right">Weights of each file in the final counts.</td><td style="text-align: right"><code>Vector{Float64}</code></td><td style="text-align: right">If the trajectories have different lengths or number of frames, the weights are adapted accordingly.</td></tr></table><h3 id="Other-parameters-available-which-are-user-input-values:"><a class="docs-heading-anchor" href="#Other-parameters-available-which-are-user-input-values:">Other parameters available which are user input values:</a><a id="Other-parameters-available-which-are-user-input-values:-1"></a><a class="docs-heading-anchor-permalink" href="#Other-parameters-available-which-are-user-input-values:" title="Permalink"></a></h3><table><tr><th style="text-align: right">Parameter</th><th style="text-align: right">Meaning</th><th style="text-align: right">Type of value</th><th style="text-align: right">Comment</th></tr><tr><td style="text-align: right"><code>nbins</code></td><td style="text-align: right">Number of bins of the histograms.</td><td style="text-align: right"><code>Int</code></td><td style="text-align: right"></td></tr><tr><td style="text-align: right"><code>dbulk</code></td><td style="text-align: right">Distance from solute of bulk solution.</td><td style="text-align: right"><code>Float64</code></td><td style="text-align: right"></td></tr><tr><td style="text-align: right"><code>cutoff</code></td><td style="text-align: right">Maximum distance to be considered for histograms.</td><td style="text-align: right"><code>Float64</code></td><td style="text-align: right"></td></tr><tr><td style="text-align: right"><code>autocorrelation</code></td><td style="text-align: right">The solute is the same as the solvent?</td><td style="text-align: right"><code>Bool</code></td><td style="text-align: right">Automatically set if <code>solute == solvent</code>.</td></tr><tr><td style="text-align: right"><code>solute</code></td><td style="text-align: right">Properties of the solute</td><td style="text-align: right"><code>SolSummary</code></td><td style="text-align: right">Contains the number of atoms, number of atoms per molecule and number of molecules of the solute.</td></tr><tr><td style="text-align: right"><code>solvent</code></td><td style="text-align: right">Properties of the solvent.</td><td style="text-align: right"><code>SolSummary</code></td><td style="text-align: right">Contains the number of atoms, number of atoms per molecule and number of molecules of the solvent.</td></tr><tr><td style="text-align: right"><code>irefatom</code></td><td style="text-align: right">This is a reference atom that is used to generate random rotations and translations internally.</td><td style="text-align: right"><code>Int</code></td><td style="text-align: right">Counts of the distributions for this atom are performed automatically to obtain radial (or proximal) distribution functions. Can be used for testing purposes.</td></tr><tr><td style="text-align: right"><code>rdf_count</code></td><td style="text-align: right">This is the <code>md_count</code> minimum distance count of <code>irefatom</code>.</td><td style="text-align: right"><code>Vector{Float64}</code></td><td style="text-align: right">This corresponds to the conventional radial distribution function if the solute contains only one atom as well.</td></tr><tr><td style="text-align: right"><code>rdf_count_random</code></td><td style="text-align: right">Minimum distance of <code>irefatom</code> count for the random distribution.</td><td style="text-align: right"><code>Vector{Float64}</code></td><td style="text-align: right"></td></tr><tr><td style="text-align: right"><code>rdf</code></td><td style="text-align: right">Distribution function computed from the <code>irefatom</code> distribution. It is a conventional <code>rdf</code> if the solvent has only one atom.</td><td style="text-align: right"><code>Vector{Float64}</code></td><td style="text-align: right"></td></tr><tr><td style="text-align: right"><code>kb_rdf</code></td><td style="text-align: right">Kirkwood-Buff integral computed from the <code>irefatom</code> distribution.</td><td style="text-align: right"><code>Vector{Float64}</code></td><td style="text-align: right">This must converge, at long distances, to the same value as <code>kb</code>, and can be used for testing.</td></tr><tr><td style="text-align: right"><code>options</code></td><td style="text-align: right">Calculation options.</td><td style="text-align: right"><code>Options</code></td><td style="text-align: right">Carries (some redundant) options set by the user.</td></tr><tr><td style="text-align: right"><code>lastframe_read</code></td><td style="text-align: right">Last frame read from the trajectory.</td><td style="text-align: right"><code>Int</code></td><td style="text-align: right"></td></tr><tr><td style="text-align: right"><code>n_frames_read</code></td><td style="text-align: right">Number of frames read from the trajectory.</td><td style="text-align: right"><code>Int</code></td><td style="text-align: right">Can differ from <code>lastframe_read</code> if <code>stride != 1</code></td></tr></table></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../mddf/">« Computing the MDDF</a><a class="docs-footer-nextpage" href="../contrib/">Atomic and group contributions »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.10 on <span class="colophon-date" title="Thursday 18 November 2021 17:57">Thursday 18 November 2021</span>. Using Julia version 1.6.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
