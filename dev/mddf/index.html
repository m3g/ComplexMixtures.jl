<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Computing the MDDF · ComplexMixtures.jl</title><meta name="title" content="Computing the MDDF · ComplexMixtures.jl"/><meta property="og:title" content="Computing the MDDF · ComplexMixtures.jl"/><meta property="twitter:title" content="Computing the MDDF · ComplexMixtures.jl"/><meta name="description" content="Documentation for ComplexMixtures.jl."/><meta property="og:description" content="Documentation for ComplexMixtures.jl."/><meta property="twitter:description" content="Documentation for ComplexMixtures.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img class="docs-light-only" src="../assets/logo.svg" alt="ComplexMixtures.jl logo"/><img class="docs-dark-only" src="../assets/logo-dark.svg" alt="ComplexMixtures.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">ComplexMixtures.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Introduction</a></li><li><span class="tocitem">Install and run</span><ul><li><a class="tocitem" href="../installation/">Installation</a></li><li><a class="tocitem" href="../parallel/">Parallel execution</a></li><li><a class="tocitem" href="../python/">From Python</a></li></ul></li><li><a class="tocitem" href="../quickguide/">Quick Guide</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../examples/">Running the examples</a></li><li><a class="tocitem" href="../example1/">Protein in water/glycerol</a></li><li><a class="tocitem" href="../example2/">Polyacrylamide in DMF</a></li><li><a class="tocitem" href="../example3/">POPC membrane in water/ethanol</a></li><li><a class="tocitem" href="../example4/">Water/Glycerol mixture</a></li></ul></li><li><span class="tocitem">Setup and run</span><ul><li><a class="tocitem" href="../selection/">Set solute and solvent</a></li><li class="is-active"><a class="tocitem" href>Computing the MDDF</a><ul class="internal"><li><a class="tocitem" href="#Minimum-Distance-Distribution-Function"><span>Minimum-Distance Distribution Function</span></a></li><li><a class="tocitem" href="#Coordination-numbers-only"><span>Coordination numbers only</span></a></li></ul></li><li><a class="tocitem" href="../save/">Save and load</a></li><li><a class="tocitem" href="../multiple/">Multiple trajectories</a></li><li><a class="tocitem" href="../options/">Options</a></li></ul></li><li><span class="tocitem">Analysis</span><ul><li><a class="tocitem" href="../results/">Results</a></li><li><a class="tocitem" href="../contributions/">Atomic and group contributions</a></li><li><a class="tocitem" href="../density_maps/">Density maps</a></li><li><a class="tocitem" href="../coordination_numbers/">Coordination numbers</a></li><li><a class="tocitem" href="../tools/">Tools</a></li></ul></li><li><a class="tocitem" href="../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Setup and run</a></li><li class="is-active"><a href>Computing the MDDF</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Computing the MDDF</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/m3g/ComplexMixtures.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/m3g/ComplexMixtures.jl/blob/main/docs/src/mddf.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Computing-the-MDDF"><a class="docs-heading-anchor" href="#Computing-the-MDDF">Computing the MDDF</a><a id="Computing-the-MDDF-1"></a><a class="docs-heading-anchor-permalink" href="#Computing-the-MDDF" title="Permalink"></a></h1><h2 id="Minimum-Distance-Distribution-Function"><a class="docs-heading-anchor" href="#Minimum-Distance-Distribution-Function">Minimum-Distance Distribution Function</a><a id="Minimum-Distance-Distribution-Function-1"></a><a class="docs-heading-anchor-permalink" href="#Minimum-Distance-Distribution-Function" title="Permalink"></a></h2><p>The main function of the ComplexMixtures package actually computes the MDDF between the solute and the solvent chosen. </p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ComplexMixtures.mddf" href="#ComplexMixtures.mddf"><code>ComplexMixtures.mddf</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mddf(
    trajectory_file::String, 
    solute::AtomSelection,
    solvent::AtomSelection, # optional: if omitted, an auto-correlation will be computed
    options::Options=Options(); # optional: if omitted, default options will be used
    # optional keywords:
    trajectory_format=&quot;&quot;, 
    frame_weights = Float64[], 
    coordination_number_only = false, 
    low_memory = false, 
    chemfiles = false,
)</code></pre><p>Computes the minimum-distance distribution function, atomic contributions, and  KB integrals, given the trajectory file name, and the definition of the solute and solvent groups of atoms as <code>AtomSelection</code> data structures. If the <code>solvent</code> parameter is omitted, a self-correlation will be computed.</p><p>This is the main function of the <code>ComplexMixtures</code> package. </p><p>The <code>options</code> parameter is optional. If not set, the default <code>Options()</code> structure will be used.</p><p><strong>Optional execution keywords</strong></p><ul><li><p><code>trajectory_format</code> is a string that defines the format of the trajectory file. If not provided, the format  will be guessed from the file extension, and the <code>Chemfiles</code> library will be used to read the trajectory. </p></li><li><p><code>frame_weights</code> is an array of weights for each frame of the trajectory. If this is provided, the MDDF will be computed as a weighted average of the MDDFs of each frame. This can be used to study the solvation dependency in perturbed  ensembles.</p></li><li><p><code>coordination_number_only</code> is a boolean that, if set to <code>true</code>, will compute only the site-counts and coordination numbers of the solvent molecules around the solute, and not the MDDF, RDF, or KB integrals.  This is useful when the normalization of the distribution is not possible or needed, for instance when the bulk solution is not properly defined. The computation is much faster in this case. The call to <code>mddf</code> with this option is equivalent to direct the call to <code>coordination_number</code>.</p></li><li><p><code>low_memory</code> can be set to <code>true</code> to reduce the memory requirements of the computation. This will parallelize the computation of the minimum distances at a lower level, reducing the memory requirements at the expense of some performance.</p></li><li><p><code>chemfiles</code> is a boolean that, if set to <code>true</code>, will use try to use the <code>Chemfiles</code> library to read the trajectory file.  independently of the file extension. By default, PDB and DCD trajectories are read by specific readers.</p></li></ul><div class="admonition is-compat" id="Compat-e04127b4c4947e08"><header class="admonition-header">Compat<a class="admonition-anchor" href="#Compat-e04127b4c4947e08" title="Permalink"></a></header><div class="admonition-body"><p>The current call signature was introduced in version 2.9.0. The previous call signature with the  previous construction of the <code>Trajectory</code> object, is still available, but it is no longer recommended  because it more prone to user-level solute and solvent configuration errors. </p></div></div><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; using ComplexMixtures, PDBTools

julia&gt; using ComplexMixtures.Testing: data_dir

julia&gt; atoms = readPDB(joinpath(data_dir,&quot;NAMD/structure.pdb&quot;));

julia&gt; solute = AtomSelection(select(atoms, &quot;protein&quot;), nmols=1);

julia&gt; solvent = AtomSelection(select(atoms, &quot;resname TMAO&quot;), natomspermol=14);

julia&gt; options = Options(lastframe=10, bulk_range=(10.0, 15.0));

julia&gt; trajectory_file = joinpath(data_dir,&quot;NAMD/trajectory.dcd&quot;);

julia&gt; results = mddf(trajectory_file, solute, solvent, options);</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/m3g/ComplexMixtures.jl/blob/9b87e3f27d81e6b1f68622dd45ceec606d76dfa1/src/mddf.jl#L111-L182">source</a></section></article><p>The <code>mddf</code> functions is run with, for example:</p><pre><code class="language-julia hljs">results = mddf(trajectory_file, solute, solvent, Options(bulk_range=(10.0, 15.0)))  </code></pre><p>The MDDF along with other results, like the corresponding KB integrals, are returned in the <code>results</code> data structure, which is described in the <a href="../results/#results">next section</a>.</p><p>It is possible to tune several options of the calculation, by setting the <code>Options</code> data structure with user-defined values in advance. The most common parameters to be set by the user are <code>bulk_range</code> and <code>stride</code>. </p><p><code>stride</code> defines if some frames will be skip during the calculation (for speedup). For example, if <code>stride=5</code>, only one in five frames will be considered. Adjust stride with:  </p><pre><code class="language-julia hljs">options = Options(stride=5, bulk_range=(10.0, 15.0))
results = mddf(trajectory_file, solute, solvent, options)</code></pre><div class="admonition is-info" id="Note-bafb09bd5293fb89"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-bafb09bd5293fb89" title="Permalink"></a></header><div class="admonition-body"><p><code>bulk_range</code> defines the subset of the system, as defined according to a range of distances from the solute, that are to be considered as the bulk solution. Within this range of distances, the user  believes that the reference solute molecule does not significantly affect anymore the structure of the solvent. </p><p>By default, all molecules above 10 Angstroms from the solute are considered bulk molecules (corresponding to <code>Options(dbulk=10.0)</code>), but it is <em>highly recommended</em> to use a manual definition of <code>bulk_range</code>.</p><p>The definition of a range of distances within the system to compute the bulk density is adequate because this system subset is then an open system with a solvent molecule reservoir. The adequate choice of <code>bulk_range</code> can be inspected by the proper convergence of the distribution functions (which must converge to 1.0) and a proper convergence of the KB integrals.</p><p>The <code>bulk_range</code> option was introduced in version 2.1.0.</p></div></div><p>See the <a href="../options/#options">Options</a> section for further details and other options to set.</p><h2 id="Coordination-numbers-only"><a class="docs-heading-anchor" href="#Coordination-numbers-only">Coordination numbers only</a><a id="Coordination-numbers-only-1"></a><a class="docs-heading-anchor-permalink" href="#Coordination-numbers-only" title="Permalink"></a></h2><p>The coordination number is the unnormalized count of how many molecules of the solvent are within a given distance to the solute. Coordination numbers can be computed  for systems where the normalization of the distribution functions is not possible (or needed) because of an ill definition of an ideal-gas state. For example,  in highly heterogeneous systems, on in systems with only a few molecules of the  &quot;solvent&quot;, the density of the bulk solution might not be properly defined.   </p><p>In these cases, nevertheless, coordination numbers can be computed and still  provide valuable information about the molecular structure of the system. Coordination number can be computed also from the results obtained from a <code>mddf</code> run, as explained in  the <a href="../coordination_numbers/#coordination_number">corresponding section of the Tools menu</a>.</p><p>The <code>coordination_number</code> function, called with the same arguments as the <code>mddf</code> function, can be used to compute coordination numbers without the normalization required for the MDDF, providing (possibly much) faster computations when the  normalization is not possible or required:</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MolSimToolkitShared.coordination_number-Tuple{String, AtomSelection, AtomSelection, Options}" href="#MolSimToolkitShared.coordination_number-Tuple{String, AtomSelection, AtomSelection, Options}"><code>MolSimToolkitShared.coordination_number</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">coordination_number(
    trajectory_file::String, 
    solute::AtomSelection,
    solvent::AtomSelection, # optional: if omitted, an auto-correlation will be computed
    options::Options=Options(); # optional: if omitted, default options will be used
    # optional keywords:
    trajectory_format=&quot;&quot;, 
    frame_weights = Float64[], 
    low_memory = false, 
)</code></pre><p>Computes the minimum-distance coordination number and atomic contributions, given the trajectory file name, and the definition of the solute and solvent groups of atoms as <code>AtomSelection</code> data structures. If the <code>solvent</code> parameter is omitted, a self-coordination number will be computed.</p><p>The output is a <code>Result</code> structure, which contains the data as the result of a call to <code>mddf</code>, except that all counters which require normalization of the distribution will be zero. In summary, this result data structure can be used to compute the coordination numbers, but not the MDDF, RDF, or KB integrals.</p><p>The <code>options</code> parameter is optional. If not set, the default <code>Options()</code> structure will be used.</p><p><strong>Optional execution keywords</strong></p><ul><li><p><code>trajectory_format</code> is a string that defines the format of the trajectory file. If not provided, the format  will be guessed from the file extension, and the <code>Chemfiles</code> library will be used to read the trajectory. </p></li><li><p><code>frame_weights</code> is an array of weights for each frame of the trajectory. If this is provided, the MDDF will be computed as a weighted average of the MDDFs of each frame. This can be used to study the solvation dependency in perturbed  ensembles.</p></li><li><p><code>low_memory</code> can be set to <code>true</code> to reduce the memory requirements of the computation. This will parallelize the computation of the minimum distances at a lower level, reducing the memory requirements at the expense of some performance.</p></li><li><p><code>chemfiles</code> is a boolean that, if set to <code>true</code>, will use try to use the <code>Chemfiles</code> library to read the trajectory file.  independently of the file extension. By default, PDB and DCD trajectories are read by specific readers.</p></li></ul><div class="admonition is-compat" id="Compat-e04127b4c4947e08"><header class="admonition-header">Compat<a class="admonition-anchor" href="#Compat-e04127b4c4947e08" title="Permalink"></a></header><div class="admonition-body"><p>The current call signature was introduced in version 2.9.0. The previous call signature with the  previous construction of the <code>Trajectory</code> object, is still available, but it is no longer recommended  because it more prone to user-level solute and solvent configuration errors. </p></div></div><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; using ComplexMixtures, PDBTools

julia&gt; using ComplexMixtures.Testing: data_dir

julia&gt; atoms = readPDB(joinpath(data_dir,&quot;NAMD/structure.pdb&quot;));

julia&gt; solute = AtomSelection(select(atoms, &quot;protein&quot;), nmols=1);

julia&gt; solvent = AtomSelection(select(atoms, &quot;resname TMAO&quot;), natomspermol=14);

julia&gt; options = Options(lastframe=10, bulk_range=(10.0, 15.0));

julia&gt; trajectory_file = joinpath(data_dir,&quot;NAMD/trajectory.dcd&quot;);

julia&gt; results = coordination_number(trajectory_file, solute, solvent, options);</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/m3g/ComplexMixtures.jl/blob/9b87e3f27d81e6b1f68622dd45ceec606d76dfa1/src/mddf.jl#L476-L541">source</a></section></article><div class="admonition is-info" id="Note-bb785e7742f885b7"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-bb785e7742f885b7" title="Permalink"></a></header><div class="admonition-body"><p>The <code>mddf</code>, <code>kb</code>, and random count parameters will be filled with zeros when using  this options, and are meaningless. </p></div></div></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../selection/">« Set solute and solvent</a><a class="docs-footer-nextpage" href="../save/">Save and load »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.13.0 on <span class="colophon-date" title="Wednesday 2 July 2025 16:48">Wednesday 2 July 2025</span>. Using Julia version 1.10.10.</p></section><footer class="modal-card-foot"></footer></div></div></div></body><div data-docstringscollapsed="true"></div></html>
